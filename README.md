# Dating Bot & WebApp

Telegram-–±–æ—Ç –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤ —Å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º (WebApp). –ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º —Å—Ç–µ–∫–µ: aiogram 3, SQLAlchemy 2.0 —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º –¥—Ä–∞–π–≤–µ—Ä–æ–º, PostgreSQL, Docker, –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º CI/CD –Ω–∞ GitHub Actions.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–∏-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- [–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞](#–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –û–∫—Ä—É–∂–µ–Ω–∏—è](#–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ-–æ–∫—Ä—É–∂–µ–Ω–∏—è)
- [–ë—ã—Å—Ç—Ä—ã–π –°—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ CI/CD](#—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ-—á–µ—Ä–µ–∑-cicd)
- [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ü—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –û—Ç–ª–∞–¥–∫–∞](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–æ—Ç–ª–∞–¥–∫–∞)

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –û–±—â–∞—è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —á–µ—Ç—ã—Ä–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö:

```
                                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                    ‚îÇ   Telegram   ‚îÇ
                                    ‚îÇ    Users     ‚îÇ
                                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                           ‚îÇ
                                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Traefik    ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ   Bot App    ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ  PostgreSQL  ‚îÇ
‚îÇ HTTPS Proxy  ‚îÇ      ‚îÇ  (Python)    ‚îÇ      ‚îÇ   Database   ‚îÇ
‚îÇ  (SSL/TLS)   ‚îÇ      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   WebApp     ‚îÇ
‚îÇ   (nginx)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü—Ä–æ–¥–∞–∫—à–Ω-–æ–∫—Ä—É–∂–µ–Ω–∏–µ** –≤–∫–ª—é—á–∞–µ—Ç:
- **Traefik** - reverse proxy —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–ª—É—á–µ–Ω–∏–µ–º SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –æ—Ç Let's Encrypt
- **HTTPS** - –≤—Å–µ –≤–Ω–µ—à–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∑–∞—â–∏—â–µ–Ω—ã TLS (–ø–æ—Ä—Ç—ã 80‚Üí443)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ HTTP ‚Üí HTTPS

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –°–∏—Å—Ç–µ–º—ã

#### 1. **Telegram Bot (bot/)**

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û—Å–Ω–æ–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —á–µ—Ä–µ–∑ Telegram.

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**:
- **aiogram 3.x** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Telegram Bot API
- **Python 3.11+** - –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **SQLAlchemy 2.0** - ORM —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º –¥—Ä–∞–π–≤–µ—Ä–æ–º –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–¥—É–ª–∏**:
- `bot/main.py` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –º–∞—Ç—á–∏–Ω–≥–∞
- `bot/config.py` - –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `bot/db.py` - –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (ProfileModel) –∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (ProfileRepository)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**:
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ `/start`, `/cancel`, `/reset`, `/debug`, `/analytics`
- –ü—Ä–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –∏–∑ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ WebAppData
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π –≤ –ë–î
- –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ –≤–∑–∞–∏–º–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π (mutual matching)
- –£–º–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–±–æ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤, –ª–æ–∫–∞—Ü–∏–∏, —Ü–µ–ª–∏ –∏ –≤–æ–∑—Ä–∞—Å—Ç–∞
- –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø–∞—Ä–∞—Ö
- –°–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã**:
- `/start` - –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º, –æ—Ç–∫—Ä—ã—Ç—å –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- `/cancel`, `/reset` - –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é –æ–ø–µ—Ä–∞—Ü–∏—é
- `/matches` - –ø–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –º–∞—Ç—á–µ–π —Å –¥–µ—Ç–∞–ª—è–º–∏ –ø—Ä–æ—Ñ–∏–ª–µ–π
- `/stats` - –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—Ç—á–µ–π, –ª–∞–π–∫–æ–≤, –ø—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞)
- `/analytics` - –ø–æ–∫–∞–∑–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É (–æ–±—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, engagement)
- `/debug` - –ø–æ–∫–∞–∑–∞—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (—Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)

#### 2. **PostgreSQL Database (db)**

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π –∏ –¥–∞–Ω–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π.

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**:
- PostgreSQL 15 Alpine (–ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π –æ–±—Ä–∞–∑)
- Volume `postgres_data` –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- Health check –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –±–æ—Ç–∞

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö**:
- –¢–∞–±–ª–∏—Ü–∞ `profiles` - –ø—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
  - `id` (primary key, autoincrement)
  - `user_id` (unique, indexed) - Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `name`, `age`, `gender`, `preference` - –±–∞–∑–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
  - `bio`, `location` - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
  - `interests` (JSONB) - —Å–ø–∏—Å–æ–∫ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤
  - `goal` - —Ü–µ–ª—å –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞
  - `photo_file_id`, `photo_url` - —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –ø—Ä–æ—Ñ–∏–ª—è

- –¢–∞–±–ª–∏—Ü–∞ `user_interactions` - –ª–∞–π–∫–∏ –∏ –¥–∏–∑–ª–∞–π–∫–∏:
  - `id`, `from_user_id`, `to_user_id`
  - `action` ('like' –∏–ª–∏ 'dislike')
  - `created_at` - –≤—Ä–µ–º—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
  - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –ø–æ –ø–∞—Ä–µ (from_user_id, to_user_id)

- –¢–∞–±–ª–∏—Ü–∞ `matches` - –≤–∑–∞–∏–º–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è:
  - `id`, `user1_id`, `user2_id`
  - `created_at` - –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ç—á–∞
  - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –ø–æ –ø–∞—Ä–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

- –¢–∞–±–ª–∏—Ü–∞ `user_settings` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
  - `id`, `user_id` (unique, indexed)
  - `lang`, `show_location`, `show_age`
  - `notify_matches`, `notify_messages`
  - `created_at`, `updated_at`

#### 3. **WebApp (webapp/)**

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: Telegram Mini App –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∞–Ω–∫–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**:
- –°—Ç–∞—Ç–∏—á–Ω—ã–π HTML/CSS/JavaScript
- Telegram WebApp API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- nginx –∫–∞–∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**:
- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è
- –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–Ω–æ–≤–∏–∫–∞ –≤ localStorage
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
- –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç—É —á–µ—Ä–µ–∑ Telegram WebApp API

#### 4. **Traefik Reverse Proxy (traefik)**

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: HTTPS-–ø—Ä–æ–∫—Å–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏.

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**:
- **Traefik v2.11** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π reverse proxy –∏ load balancer
- **Let's Encrypt** - –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
- **ACME TLS-Challenge** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤—ã–¥–∞—á–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**:
- –¢–µ—Ä–º–∏–Ω–∞—Ü–∏—è SSL/TLS —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ Let's Encrypt
- –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ HTTP ‚Üí HTTPS
- –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ WebApp
- –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ Docker volume `traefik_certs`

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**:
- –°–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç—ã 80 (HTTP) –∏ 443 (HTTPS)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Docker labels –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∑–∞ 30 –¥–Ω–µ–π –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω**: Traefik —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π DNS (–¥–æ–º–µ–Ω –¥–æ–ª–∂–µ–Ω —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ IP —Å–µ—Ä–≤–µ—Ä–∞) –∏ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã 80/443 –≤ firewall.

#### 5. **–ú–∏–≥—Ä–∞—Ü–∏–∏ (migrations/)**

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**:
- **Alembic** - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –º–∏–≥—Ä–∞—Ü–∏–π –¥–ª—è SQLAlchemy
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞ (–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `RUN_DB_MIGRATIONS`)

**–§–∞–π–ª—ã**:
- `migrations/env.py` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Alembic
- `migrations/versions/` - —Ñ–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π
- `alembic.ini` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Alembic

#### 6. **CI/CD Pipeline (.github/workflows/)**

**–§–∞–π–ª—ã**:
- `ci.yml` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–±–æ—Ä–∫–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º push/PR
- `deploy.yml` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–æ–π —Å–µ—Ä–≤–µ—Ä–∞

**–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–µ–ø–ª–æ—è**:
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –∏ Docker Compose –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç)
- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π HTTPS —á–µ—Ä–µ–∑ Traefik

**–ü–æ–¥—Ä–æ–±–Ω–µ–µ**: —Å–º. —Ä–∞–∑–¥–µ–ª [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ CI/CD](#—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ-—á–µ—Ä–µ–∑-cicd)

---

## üéØ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π –¶–∏–∫–ª –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí /start ‚Üí –ü–æ–∫–∞–∑ –∫–Ω–æ–ø–∫–∏ "–û—Ç–∫—Ä—ã—Ç—å –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"
                              ‚Üì
2. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç WebApp ‚Üí –ó–∞–ø–æ–ª–Ω—è–µ—Ç –∞–Ω–∫–µ—Ç—É ‚Üí –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç—É
                              ‚Üì
3. –ë–æ—Ç ‚Üí –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö ‚Üí –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
                              ‚Üì
4. –ë–æ—Ç ‚Üí –ü–æ–∏—Å–∫ mutual match ‚Üí –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–Ω–∫–µ—Ç –æ–±–æ–∏–º
                              ‚Üì
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ ‚Üí –ü—Ä–æ–¥–æ–ª–∂–∞—é—Ç –æ–±—â–µ–Ω–∏–µ –≤ Telegram
```

### –°–∏—Å—Ç–µ–º–∞ –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π (Likes & Matches)

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–∞–π–∫–æ–≤ –∏ —Å–≤–∞–π–ø–æ–≤:

**–î–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**:
- **Like (–õ–∞–π–∫)** - –≤—ã—Ä–∞–∂–µ–Ω–∏–µ —Å–∏–º–ø–∞—Ç–∏–∏ –∫ –¥—Ä—É–≥–æ–º—É –ø—Ä–æ—Ñ–∏–ª—é
- **Dislike (–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å)** - –ø—Ä–æ–ø—É—Å–∫ –ø—Ä–æ—Ñ–∏–ª—è –±–µ–∑ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

**–ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ç—á–∞**:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å A –ª–∞–π–∫–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è B
2. –°–∏—Å—Ç–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
3. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å B —Ä–∞–Ω–µ–µ –ª–∞–π–∫–Ω—É–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è A:
   - –°–æ–∑–¥–∞–µ—Ç—Å—è **Match** (–≤–∑–∞–∏–º–Ω–∞—è —Å–∏–º–ø–∞—Ç–∏—è)
   - –û–±–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–ª—É—á–∞—é—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
   - –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø–æ–ª–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞

**–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**:
- –¢–∞–±–ª–∏—Ü–∞ `user_interactions` - –≤—Å–µ –ª–∞–π–∫–∏ –∏ –¥–∏–∑–ª–∞–π–∫–∏
- –¢–∞–±–ª–∏—Ü–∞ `matches` - –≤–∑–∞–∏–º–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
- –¢–∞–±–ª–∏—Ü–∞ `user_settings` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –ê–ª–≥–æ—Ä–∏—Ç–º –ü–æ–∏—Å–∫–∞ –°–æ–≤–ø–∞–¥–µ–Ω–∏–π (Mutual Matching)

–ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ **–Ω–æ–≤–æ–≥–æ** –ø—Ä–æ—Ñ–∏–ª—è –±–æ—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–∏—Å–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π:

1. **–§–∏–ª—å—Ç—Ä –ø–æ –≥–µ–Ω–¥–µ—Ä—É**: 
   - –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏—â–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≥–µ–Ω–¥–µ—Ä (male/female/other), —Å–∏—Å—Ç–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ —ç—Ç–æ–º—É –∫—Ä–∏—Ç–µ—Ä–∏—é
   - –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª "any", —Ñ–∏–ª—å—Ç—Ä –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

2. **–í–∑–∞–∏–º–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**:
   - –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –Ω–∞–π–¥–µ–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å —Ç–∞–∫–∂–µ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω –≤ –≥–µ–Ω–¥–µ—Ä–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è "any" preference –∫–∞–∫ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

3. **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Å–µ–±—è**:
   - –ü—Ä–æ—Ñ–∏–ª—å –Ω–µ –º–æ–∂–µ—Ç —Å–æ–≤–ø–∞—Å—Ç—å —Å–∞–º —Å —Å–æ–±–æ–π

4. **–ü–µ—Ä–≤–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ**:
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–π –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø—Ä–æ—Ñ–∏–ª—å (LIMIT 1)
   - –≠—Ç–æ –±–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è, –≤ –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–µ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ù–∞—Å—Ç—Ä–æ–µ–∫

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –¥–≤—É—Ö –º–µ—Å—Ç–∞—Ö:
- **localStorage** –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏)

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∫–ª—é—á–∞—é—Ç:
- –Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–æ–∑—Ä–∞—Å—Ç–∞
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –º–∞—Ç—á–∞—Ö
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö

–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –±–æ—Ç—É —á–µ—Ä–µ–∑ WebApp API.

### –í–∞–ª–∏–¥–∞—Ü–∏—è –î–∞–Ω–Ω—ã—Ö

**–ù–∞ —É—Ä–æ–≤–Ω–µ –±–æ—Ç–∞ (Python)**:
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: `name`, `age`, `gender`, `preference`
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç: 18 –ª–µ—Ç
- –§–æ—Ä–º–∞—Ç photo_url: —Ç–æ–ª—å–∫–æ HTTPS
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≥–µ–Ω–¥–µ—Ä–æ–≤/–ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π (—Ä—É—Å—Å–∫–∏–π/–∞–Ω–≥–ª–∏–π—Å–∫–∏–π ‚Üí –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ü–µ–ª–µ–π –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞

**–ù–∞ —É—Ä–æ–≤–Ω–µ WebApp (JavaScript)**:
- Real-time –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≤–≤–æ–¥–∞
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø—É—Å—Ç—ã—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª—è—Ö

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–æ—Ç–æ:
1. **photo_url** - HTTPS —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–æ—Ç–æ (–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è)
2. **photo_file_id** - File ID –∏–∑ Telegram (–¥–ª—è –±—É–¥—É—â–µ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä—è–º–æ–π –∑–∞–≥—Ä—É–∑–∫–∏)

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –£–¥–∞–ª–µ–Ω–∏–µ –ü—Ä–æ—Ñ–∏–ª—è

- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ WebApp –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø—Ä–æ—Ñ–∏–ª—å
- **–£–¥–∞–ª–µ–Ω–∏–µ**: –æ—Ç–ø—Ä–∞–≤–∫–∞ `{"action": "delete"}` –∏–∑ WebApp —É–¥–∞–ª—è–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –∏–∑ –ë–î

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ—Ç–∫–ª–∏–∫–∞:

**1. –ò–Ω–¥–µ–∫—Å—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**:
- `ix_profiles_age` - –±—ã—Å—Ç—Ä–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É
- `ix_profiles_location` - –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- `ix_profiles_gender_preference` - –ø–æ–∏—Å–∫ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `ix_profiles_preference_age` - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

**2. In-Memory –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**:
- –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (TTL: 5 –º–∏–Ω—É—Ç)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (TTL: 10 –º–∏–Ω—É—Ç)
- –°–ø–∏—Å–∫–∏ –º–∞—Ç—á–µ–π (TTL: 3 –º–∏–Ω—É—Ç—ã)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- Hit rate: 75-85% –ø—Ä–∏ —Ç–∏–ø–∏—á–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ

**3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤**:
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ SQL –≤–º–µ—Å—Ç–æ Python
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∫–∏ –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö
- Batch-–∑–∞–≥—Ä—É–∑–∫–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è –≤—Å–µ—Ö —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**:
- –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ API: ‚Üì 70-73%
- –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö: ‚Üì ~40%
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (—á–µ—Ä–µ–∑ –∫—ç—à): ‚Üì 97%

–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ [SPRINT5_TASK2_SUMMARY.md](SPRINT5_TASK2_SUMMARY.md)

---

## üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
- **Python 3.11+**
- **PostgreSQL 14+** (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker Compose)
- **Docker & Docker Compose** (–¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞)

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:
- **–°–µ—Ä–≤–µ—Ä** —Å SSH –¥–æ—Å—Ç—É–ø–æ–º
- **Docker & Docker Compose** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- **Telegram Bot Token** (–ø–æ–ª—É—á–∏—Ç—å —É @BotFather)
- **–ü—É–±–ª–∏—á–Ω—ã–π URL** –¥–ª—è WebApp (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

---

## üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –û–∫—Ä—É–∂–µ–Ω–∏—è

–ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å–º. –≤ —Ñ–∞–π–ª–µ [`.env.example`](.env.example).

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|------------|----------|--------|
| `BOT_TOKEN` | –¢–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞ –æ—Ç @BotFather | `123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11` |

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|----------|--------------|
| `POSTGRES_DB` | –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL | `dating` |
| `POSTGRES_USER` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å PostgreSQL | `dating` |
| `POSTGRES_PASSWORD` | –ü–∞—Ä–æ–ª—å PostgreSQL | `dating` |
| `POSTGRES_PORT` | –ü–æ—Ä—Ç PostgreSQL | `5432` |
| `BOT_DATABASE_URL` | –ü—Ä—è–º–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ `POSTGRES_*` |

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|----------|--------------|
| `WEBAPP_URL` | URL –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å HTTPS –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω) | `https://localhost` |
| `DOMAIN` | –î–æ–º–µ–Ω–Ω–æ–µ –∏–º—è –¥–ª—è HTTPS (—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω) | `localhost` |
| `ACME_EMAIL` | Email –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π Let's Encrypt | `admin@example.com` |
| `HTTP_PORT` | HTTP –ø–æ—Ä—Ç (–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ HTTPS) | `80` |
| `HTTPS_PORT` | HTTPS –ø–æ—Ä—Ç | `443` |
| `ACME_CA_SERVER` | ACME —Å–µ—Ä–≤–µ—Ä (staging –¥–ª—è —Ç–µ—Å—Ç–æ–≤) | Let's Encrypt production |
| `RUN_DB_MIGRATIONS` | –ó–∞–ø—É—Å–∫–∞—Ç—å –ª–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ | `true` |
| `DEBUG` | –í–∫–ª—é—á–∏—Ç—å DEBUG –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | `false` |

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –í –ø—Ä–æ–¥–∞–∫—à–Ω –æ–∫—Ä—É–∂–µ–Ω–∏–∏ `WEBAPP_URL` –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTPS –ø—Ä–æ—Ç–æ–∫–æ–ª. HTTP —Ä–∞–∑—Ä–µ—à–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è `localhost` –∏ `127.0.0.1` –ø—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –°—Ç–∞—Ä—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–æ–¥–∞–∫—à–Ω —Å HTTPS (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—ã–ø—É—Å–∫–æ–º SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –æ—Ç Let's Encrypt:

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**:
   ```bash
   git clone https://github.com/erliona/dating.git
   cd dating
   ```

2. **–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª**:
   ```bash
   cp .env.example .env
   nano .env  # –∏–ª–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π —Ä–µ–¥–∞–∫—Ç–æ—Ä
   ```
   
   –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ:
   ```env
   BOT_TOKEN=–≤–∞—à-—Ç–æ–∫–µ–Ω-–æ—Ç-botfather
   DOMAIN=–≤–∞—à-–¥–æ–º–µ–Ω.com
   ACME_EMAIL=–≤–∞—à-email@example.com
   WEBAPP_URL=https://–≤–∞—à-–¥–æ–º–µ–Ω.com
   
   # –î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –ë–î
   POSTGRES_PASSWORD=–Ω–∞–¥–µ–∂–Ω—ã–π-–ø–∞—Ä–æ–ª—å
   ```

3. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ DNS –Ω–∞—Å—Ç—Ä–æ–µ–Ω**:
   - –î–æ–º–µ–Ω –¥–æ–ª–∂–µ–Ω —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ IP –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
   - –ü–æ—Ä—Ç—ã 80 –∏ 443 –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã –≤ firewall

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã**:
   ```bash
   docker compose up -d --build
   ```
   
   Traefik –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∏—Ç SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç Let's Encrypt –¥–ª—è –≤–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞.

5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å**:
   ```bash
   docker compose ps
   docker compose logs traefik
   docker compose logs -f bot
   ```

6. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ HTTPS**:
   –û—Ç–∫—Ä–æ–π—Ç–µ `https://–≤–∞—à-–¥–æ–º–µ–Ω.com` –≤ –±—Ä–∞—É–∑–µ—Ä–µ - –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å HTTPS —Å –≤–∞–ª–∏–¥–Ω—ã–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –±–µ–∑ HTTPS

–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–ø—Ä–æ—â–µ–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –±–µ–∑ Traefik:

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**:
   ```bash
   git clone https://github.com/erliona/dating.git
   cd dating
   ```

2. **–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª**:
   ```bash
   cp .env.example .env
   nano .env
   ```
   
   –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
   ```env
   BOT_TOKEN=–≤–∞—à-—Ç–æ–∫–µ–Ω-–æ—Ç-botfather
   WEBAPP_URL=http://localhost:8080
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤ dev —Ä–µ–∂–∏–º–µ**:
   ```bash
   docker compose -f docker-compose.dev.yml up -d --build
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏**:
   ```bash
   docker compose logs -f bot
   ```

5. **–û—Å—Ç–∞–Ω–æ–≤–∫–∞**:
   ```bash
   docker compose -f docker-compose.dev.yml down
   ```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

1. **–°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ**:
   ```bash
   python -m venv .venv
   source .venv/bin/activate  # Windows: .venv\Scripts\activate
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
   ```bash
   pip install --upgrade pip
   pip install -r requirements.txt
   pip install -r requirements-dev.txt  # –¥–ª—è —Ç–µ—Å—Ç–æ–≤
   ```

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**:
   ```bash
   export BOT_TOKEN="your-token-here"
   export BOT_DATABASE_URL="postgresql+asyncpg://user:pass@localhost:5432/dating"
   export WEBAPP_URL="http://localhost:8080"  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
   ```

4. **–ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏**:
   ```bash
   alembic upgrade head
   ```

5. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞**:
   ```bash
   python -m bot.main
   ```

6. **–î–ª—è WebApp –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ—Å—Ç–æ–π —Å–µ—Ä–≤–µ—Ä** (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ):
   ```bash
   python -m http.server 8080 --directory webapp
   ```

---

## üîí HTTPS –∏ SSL –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ Let's Encrypt

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Traefik** –≤ –∫–∞—á–µ—Å—Ç–≤–µ reverse proxy —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–ª—É—á–µ–Ω–∏–µ–º –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –æ—Ç Let's Encrypt.

#### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **Traefik** —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç—ã 80 (HTTP) –∏ 443 (HTTPS)
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç HTTP —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ HTTPS
3. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **ACME –ø—Ä–æ—Ç–æ–∫–æ–ª** (TLS-Challenge) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
4. –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Docker volume `traefik_certs`
5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∑–∞ 30 –¥–Ω–µ–π –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è

#### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞:

- ‚úÖ –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ–º–µ–Ω —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º DNS (A-–∑–∞–ø–∏—Å—å –Ω–∞ IP —Å–µ—Ä–≤–µ—Ä–∞)
- ‚úÖ –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã 80 –∏ 443 –≤ firewall
- ‚úÖ –í–∞–ª–∏–¥–Ω—ã–π email –≤ `ACME_EMAIL` –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–Ω:

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Let's Encrypt staging —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ç–µ—Å—Ç–æ–≤, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å rate limits:

```env
ACME_CA_SERVER=https://acme-staging-v02.api.letsencrypt.org/directory
```

**–í–∞–∂–Ω–æ**: Staging —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –Ω–µ –±—É–¥—É—Ç –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–∞—Ö, –Ω–æ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É.

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
openssl s_client -connect –≤–∞—à-–¥–æ–º–µ–Ω.com:443 -servername –≤–∞—à-–¥–æ–º–µ–Ω.com < /dev/null

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
echo | openssl s_client -connect –≤–∞—à-–¥–æ–º–µ–Ω.com:443 2>/dev/null | openssl x509 -noout -dates

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ Traefik
docker compose logs traefik | grep -i acme
```

#### –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏:

–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `acme.json` –≤–Ω—É—Ç—Ä–∏ volume:

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
docker compose exec traefik cat /letsencrypt/acme.json

# –û—á–∏—Å—Ç–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (–¥–ª—è –ø–µ—Ä–µ–ø–æ–ª—É—á–µ–Ω–∏—è)
docker compose down
docker volume rm dating_traefik_certs
docker compose up -d
```

#### Troubleshooting:

**–ü—Ä–æ–±–ª–µ–º–∞**: –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. DNS –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω: `nslookup –≤–∞—à-–¥–æ–º–µ–Ω.com`
2. –ü–æ—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã: `nc -zv –≤–∞—à-–¥–æ–º–µ–Ω.com 80 443`
3. Email –≤–∞–ª–∏–¥–Ω—ã–π –≤ `ACME_EMAIL`
4. –õ–æ–≥–∏ Traefik: `docker compose logs traefik`

**–ü—Ä–æ–±–ª–µ–º–∞**: Rate limit –æ—Ç Let's Encrypt

–†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ staging —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∏–ª–∏ –ø–æ–¥–æ–∂–¥–∏—Ç–µ –¥–æ —Å–±—Ä–æ—Å–∞ –ª–∏–º–∏—Ç–æ–≤ (–æ–±—ã—á–Ω–æ 1 –Ω–µ–¥–µ–ª—è).

---

## üîÑ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ CI/CD

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GitHub Actions –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è. **–í—Å—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –¥–µ–ø–ª–æ–π –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–∫–∞–∑–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.

### –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (3 –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–∞)

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings ‚Üí Secrets and variables ‚Üí Actions** –∏ –¥–æ–±–∞–≤—å—Ç–µ **—Ç–æ–ª—å–∫–æ 3 –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–∞**:

| Secret | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|--------|----------|--------|
| `DEPLOY_HOST` | IP –∏–ª–∏ hostname —Å–µ—Ä–≤–µ—Ä–∞ | `123.45.67.89` –∏–ª–∏ `server.example.com` |
| `DEPLOY_USER` | SSH –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å sudo –ø—Ä–∞–≤–∞–º–∏ | `ubuntu`, `deploy`, –∏–ª–∏ `root` |
| `DEPLOY_SSH_KEY` | –ü—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á (PEM —Ñ–æ—Ä–º–∞—Ç) | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ `~/.ssh/id_ed25519` |

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞

| Secret | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –ü—Ä–∏–º–µ—Ä |
|--------|----------|--------------|--------|
| `BOT_TOKEN` | –¢–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞ –æ—Ç @BotFather | ‚úÖ –î–∞ | `123456:ABC-DEF-your-token` |
| `DOMAIN` | –î–æ–º–µ–Ω–Ω–æ–µ –∏–º—è –¥–ª—è HTTPS | üü° –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è | `example.com` |
| `ACME_EMAIL` | Email –¥–ª—è Let's Encrypt —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π | üü° –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è | `admin@example.com` |

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã (—Å —É–º–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

| Secret | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|--------|----------|--------------|
| `DEPLOY_PATH` | –ü—É—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ | `/opt/dating` |
| `DEPLOY_PORT` | SSH –ø–æ—Ä—Ç | `22` |
| `POSTGRES_DB` | –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö | `dating` |
| `POSTGRES_USER` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î | `dating` |
| `POSTGRES_PASSWORD` | –ü–∞—Ä–æ–ª—å –ë–î | –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É –¥–µ–ø–ª–æ—è–º–∏ |
| `ACME_CA_SERVER` | ACME —Å–µ—Ä–≤–µ—Ä (–¥–ª—è —Ç–µ—Å—Ç–æ–≤) | Let's Encrypt production |

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –¥–µ–ø–ª–æ–µ CI/CD –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

1. ‚úÖ **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ Docker** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
2. ‚úÖ **–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Docker** –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç (—á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç)
3. ‚úÖ **–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Docker Compose** plugin –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
4. ‚úÖ **–°–æ–∑–¥–∞–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏** –ø—Ä–æ–µ–∫—Ç–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
5. ‚úÖ **–î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ docker group** –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–µ–∑ sudo
6. ‚úÖ **–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `.env` —Ñ–∞–π–ª** –∏–∑ —Å–µ–∫—Ä–µ—Ç–æ–≤ —Å —É–º–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
7. ‚úÖ **–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π –ø–∞—Ä–æ–ª—å –ë–î** –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É –¥–µ–ø–ª–æ—è–º–∏ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö)
8. ‚úÖ **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç HTTPS** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω DOMAIN)
9. ‚úÖ **–ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã** –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
10. ‚úÖ **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å** –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

> üí° **–í–∞–∂–Ω–æ**: –î–ª—è HTTPS —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
> - DNS –≤–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ IP —Å–µ—Ä–≤–µ—Ä–∞
> - –ü–æ—Ä—Ç—ã 80 –∏ 443 –æ—Ç–∫—Ä—ã—Ç—ã –≤ firewall
> - –£–∫–∞–∑–∞–Ω—ã —Å–µ–∫—Ä–µ—Ç—ã `DOMAIN` –∏ `ACME_EMAIL`

### Workflow: CI (–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

**–§–∞–π–ª**: `.github/workflows/ci.yml`

**–¢—Ä–∏–≥–≥–µ—Ä—ã**: 
- Push –≤ –≤–µ—Ç–∫–∏ `main`/`master`
- Pull requests –≤ `main`/`master`

**–≠—Ç–∞–ø—ã**:
1. Checkout –∫–æ–¥–∞
2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python 3.11
3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
4. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (`pytest`)
5. –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞ (–±–µ–∑ push)

### Workflow: Deploy (–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)

**–§–∞–π–ª**: `.github/workflows/deploy.yml`

**–¢—Ä–∏–≥–≥–µ—Ä—ã**:
- Push –≤ –≤–µ—Ç–∫—É `main`
- –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ `workflow_dispatch`

**–≠—Ç–∞–ø—ã**:

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤**:
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞–ª–∏—á–∏—è 3 –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤ + BOT_TOKEN
   - –ü—Ä–æ–ø—É—Å–∫ –¥–µ–ø–ª–æ—è —Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏, –µ—Å–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH**:
   - –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PEM —Ñ–æ—Ä–º–∞—Ç–∞ –∏ base64-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞ –≤ ssh-agent

3. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –≤ known_hosts**:
   - SSH keyscan –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–Ω—è—Ç–∏—è –∫–ª—é—á–∞ —Å–µ—Ä–≤–µ—Ä–∞
   - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞**:
   - –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ (`/opt/dating` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker Compose plugin –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
   - –ó–∞–ø—É—Å–∫ –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è Docker service

5. **–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞**:
   - Rsync —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
   - –ò—Å–∫–ª—é—á–µ–Ω–∏–µ `.git` –∏ `.github`

6. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**:
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ `.env` —Ñ–∞–π–ª–∞ –∏–∑ —Å–µ–∫—Ä–µ—Ç–æ–≤
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è –ë–î –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTPS –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω DOMAIN
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

7. **–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ**:
   - –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
   - –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –Ω–æ–≤—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
   - –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –æ–±—Ä–∞–∑–æ–≤

8. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏**:
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
   - –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ë–î

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Ä—É—á–Ω—É—é, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç `scripts/deploy.sh`:

```bash
# –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (—Ç–æ–ª—å–∫–æ host –∏ user)
BOT_TOKEN="your-token" scripts/deploy.sh -H server.example.com -u deploy

# –° HTTPS
BOT_TOKEN="your-token" DOMAIN="example.com" ACME_EMAIL="admin@example.com" \
  scripts/deploy.sh -H server.example.com -u deploy

# –ò–ª–∏ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
scripts/deploy.sh \
  -H server.example.com \
  -u deploy \
  -t "your-token" \
  -D example.com \
  -E admin@example.com
```

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `-H` - hostname –∏–ª–∏ IP —Å–µ—Ä–≤–µ—Ä–∞
- `-u` - SSH –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å sudo –ø—Ä–∞–≤–∞–º–∏
- `-t` –∏–ª–∏ `BOT_TOKEN` - —Ç–æ–∫–µ–Ω Telegram –±–æ—Ç–∞

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `-D` –∏–ª–∏ `DOMAIN` - –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è –¥–ª—è HTTPS
- `-E` –∏–ª–∏ `ACME_EMAIL` - email –¥–ª—è Let's Encrypt
- `-d` - –ø—É—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `/opt/dating`)
- `-i` - –ø—É—Ç—å –∫ SSH –∫–ª—é—á—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `-p` - SSH –ø–æ—Ä—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 22)

**–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**:
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Docker –∏ Docker Compose –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
- –°–æ–∑–¥–∞–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –¢–µ—Å—Ç–æ–≤

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
python -m pytest

# –° –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
python -m pytest -v

# –¢–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª
python -m pytest tests/test_config.py

# –û–¥–∏–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
python -m pytest tests/test_config.py::TestBotConfig::test_load_config_success
```

### –ü–æ–∫—Ä—ã—Ç–∏–µ –¢–µ—Å—Ç–æ–≤

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç **180 —Ç–µ—Å—Ç–æ–≤** —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞ **76%**, –ø–æ–∫—Ä—ã–≤–∞—é—â–∏—Ö:

#### 1. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** (`tests/test_config.py`) - 23 —Ç–µ—Å—Ç–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (`BOT_TOKEN`, `BOT_DATABASE_URL`)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ database URL
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ —Ç–æ–ª—å–∫–æ PostgreSQL
- –í–∞–ª–∏–¥–∞—Ü–∏—è host –∏ database name
- Fallback –Ω–∞ `DATABASE_URL`
- HTTPS —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è WEBAPP_URL

#### 2. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** (`tests/test_database.py`) - 13 —Ç–µ—Å—Ç–æ–≤
- **ProfileModel**:
  - –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
  - –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤/–∏–∑ Profile dataclass
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- **ProfileRepository**:
  - Upsert (—Å–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
  - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
  - –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
  - –ü–æ–∏—Å–∫ mutual match —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏

#### 3. **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞** (`tests/test_bot_logic.py`) - 74 —Ç–µ—Å—Ç–∞
- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≥–µ–Ω–¥–µ—Ä–∞/–ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π**: 24 —Ç–µ—Å—Ç–∞
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ –∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ
  - –†–∞–∑–ª–∏—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω–∏—è
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ü–µ–ª–µ–π –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞**: 38 —Ç–µ—Å—Ç–æ–≤
  - 4 –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (serious, friendship, networking, casual)
  - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∞–ª–∏–∞—Å—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º –∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—à–∏–±–æ—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- **–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –∏–∑ payload**: 12 —Ç–µ—Å—Ç–æ–≤
  - –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –ø–æ–ª–µ–π
  - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞ 18+
  - –í–∞–ª–∏–¥–∞—Ü–∏—è HTTPS URL
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ (list –∏ string)
  - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö optional –ø–æ–ª–µ–π

#### 4. **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∏ –º–∞—Ç—á–∏** (`tests/test_interactions.py`) - 22 —Ç–µ—Å—Ç–∞
- **UserSettingsRepository**: 4 —Ç–µ—Å—Ç–∞
  - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
  - –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **InteractionRepository**: 10 —Ç–µ—Å—Ç–æ–≤
  - –°–æ–∑–¥–∞–Ω–∏–µ –ª–∞–π–∫–æ–≤/–¥–∏–∑–ª–∞–π–∫–æ–≤
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∑–∞–∏–º–Ω—ã—Ö –ª–∞–π–∫–æ–≤
  - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ –ª–∞–π–∫–Ω—É—Ç—ã—Ö/–¥–∏–∑–ª–∞–π–∫–Ω—É—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **MatchRepository**: 8 —Ç–µ—Å—Ç–æ–≤
  - –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç—á–µ–π
  - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Ä—è–¥–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è
  - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –º–∞—Ç—á–µ–π
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –º–∞—Ç—á–∞

#### 5. **–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –±–æ—Ç–∞** (`tests/test_bot_handlers.py`) - 10 —Ç–µ—Å—Ç–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ª–∞–π–∫–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∏–∑–ª–∞–π–∫–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç—á–µ–π –ø—Ä–∏ –≤–∑–∞–∏–º–Ω—ã—Ö –ª–∞–π–∫–∞—Ö
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–æ–∑–¥–∞–Ω–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
- Debug handler —Å –º–∞—Å–∫–∏—Ä–æ–≤–∫–æ–π sensitive –¥–∞–Ω–Ω—ã—Ö

#### 6. **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏** (`tests/test_handlers_extended.py`) - 18 —Ç–µ—Å—Ç–æ–≤
- **start_handler**: 3 —Ç–µ—Å—Ç–∞
  - –û—Ç–ø—Ä–∞–≤–∫–∞ webapp –∫–Ω–æ–ø–∫–∏
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ username
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **cancel_handler**: 2 —Ç–µ—Å—Ç–∞
  - –û—á–∏—Å—Ç–∫–∞ FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è
  - –£–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
- **finalize_profile**: 4 —Ç–µ—Å—Ç–∞
  - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ë–î
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ—Ñ–∏–ª–µ–π —Å —Ñ–æ—Ç–æ
- **_format_match_message**: 4 —Ç–µ—Å—Ç–∞
  - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
  - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç–æ–≥–æ bio
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö interests
- **–§–æ—Ç–æ helpers**: 5 —Ç–µ—Å—Ç–æ–≤
  - –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ç–æ –≤ –æ—Ç–≤–µ—Ç–µ
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —Ñ–æ—Ç–æ
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏

#### 7. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã** (`tests/test_integration.py`) - 12 —Ç–µ—Å—Ç–æ–≤
- **Profile Creation Workflow**: 2 —Ç–µ—Å—Ç–∞
  - –ü–æ–ª–Ω—ã–π workflow —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è (–æ—Ç payload –¥–æ –ë–î)
  - Workflow –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è
- **Matching Workflow**: 3 —Ç–µ—Å—Ç–∞
  - –ü–æ–ª–Ω—ã–π workflow –æ—Ç –ª–∞–π–∫–∞ –¥–æ —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ç—á–∞
  - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –º–∞—Ç—á–∞ –ø—Ä–∏ dislike
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
- **User Settings Workflow**: 1 —Ç–µ—Å—Ç
  - –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- **Database Consistency**: 3 —Ç–µ—Å—Ç–∞
  - Workflow —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è
  - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
  - –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ç—á–µ–π
- **Search and Filtering**: 3 —Ç–µ—Å—Ç–∞
  - –ü–æ–∏—Å–∫ –ø–æ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è–º
  - –ü–æ–∏—Å–∫ —Å "any" preference
  - –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Å–∞–º–æ–≥–æ —Å–µ–±—è –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

#### 8. **WebApp Handler** (`tests/test_webapp_handler.py`) - 7 —Ç–µ—Å—Ç–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –∏–∑ –≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö web_app_data
- –û–±—Ä–∞–±–æ—Ç–∫–∞ action "delete"
- –û–±—Ä–∞–±–æ—Ç–∫–∞ action "settings"
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–≥–æ JSON
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–∞–ª–∏–¥–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¢–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ conftest.py                 # –§–∏–∫—Å—Ç—É—Ä—ã (in-memory –ë–î, —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π)
‚îú‚îÄ‚îÄ test_config.py              # –¢–µ—Å—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (23 —Ç–µ—Å—Ç–∞)
‚îú‚îÄ‚îÄ test_database.py            # –¢–µ—Å—Ç—ã –ë–î –∏ –º–æ–¥–µ–ª–µ–π –ø—Ä–æ—Ñ–∏–ª–µ–π (13 —Ç–µ—Å—Ç–æ–≤)
‚îú‚îÄ‚îÄ test_interactions.py        # –¢–µ—Å—Ç—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –∏ –º–∞—Ç—á–µ–π (22 —Ç–µ—Å—Ç–∞)
‚îú‚îÄ‚îÄ test_bot_handlers.py        # –¢–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –±–æ—Ç–∞ (10 —Ç–µ—Å—Ç–æ–≤)
‚îú‚îÄ‚îÄ test_handlers_extended.py  # –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã handlers (18 —Ç–µ—Å—Ç–æ–≤)
‚îú‚îÄ‚îÄ test_integration.py         # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (12 —Ç–µ—Å—Ç–æ–≤)
‚îú‚îÄ‚îÄ test_webapp_handler.py      # –¢–µ—Å—Ç—ã webapp handler (7 —Ç–µ—Å—Ç–æ–≤)
‚îî‚îÄ‚îÄ test_bot_logic.py           # –¢–µ—Å—Ç—ã –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ (74 —Ç–µ—Å—Ç–∞)
```

### –ó–∞–ø—É—Å–∫ –¢–µ—Å—Ç–æ–≤

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
pytest -v

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
pytest --cov=bot --cov-report=term --cov-report=html

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
pytest tests/test_integration.py -v

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π —Ç–µ—Å—Ç
pytest tests/test_config.py::TestBotConfig::test_load_config_success -v
```

### CI –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

–¢–µ—Å—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ GitHub Actions –ø—Ä–∏ –∫–∞–∂–¥–æ–º:
- Push –≤ `main`/`master`
- –°–æ–∑–¥–∞–Ω–∏–∏ Pull Request

**CI –≤–∫–ª—é—á–∞–µ—Ç:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å PostgreSQL
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—é –æ—Ç—á—ë—Ç–æ–≤ –æ –ø–æ–∫—Ä—ã—Ç–∏–∏ –∫–æ–¥–∞
- –ó–∞–≥—Ä—É–∑–∫—É HTML –æ—Ç—á—ë—Ç–æ–≤ –≤ artifacts
- –ü—Ä–æ–≤–µ—Ä–∫—É –º–∏–≥—Ä–∞—Ü–∏–π –ë–î
- –ü—Ä–æ–≤–µ—Ä–∫—É —Å–±–æ—Ä–∫–∏ Docker –æ–±—Ä–∞–∑–∞

–î–µ–ø–ª–æ–π **–Ω–µ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç**, –µ—Å–ª–∏ —Ç–µ—Å—Ç—ã –Ω–µ –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ü—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îú‚îÄ‚îÄ ci.yml              # CI: —Ç–µ—Å—Ç—ã –∏ —Å–±–æ—Ä–∫–∞
‚îÇ       ‚îî‚îÄ‚îÄ deploy.yml          # CD: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py               # –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ db.py                   # –ú–æ–¥–µ–ª–∏ –∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (profiles, interactions, matches, settings)
‚îÇ   ‚îî‚îÄ‚îÄ main.py                 # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞ –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îú‚îÄ‚îÄ docker/
‚îÇ   ‚îî‚îÄ‚îÄ entrypoint.sh           # Entrypoint –¥–ª—è Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îú‚îÄ‚îÄ env.py                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Alembic
‚îÇ   ‚îî‚îÄ‚îÄ versions/               # –§–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π
‚îÇ       ‚îú‚îÄ‚îÄ 20240611_0001_create_profiles_table.py
‚îÇ       ‚îî‚îÄ‚îÄ 20241201_0002_create_interactions_and_settings.py
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ deploy.sh               # –°–∫—Ä–∏–ø—Ç —Ä—É—á–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py             # Pytest fixtures
‚îÇ   ‚îú‚îÄ‚îÄ test_bot_handlers.py    # –¢–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ test_bot_logic.py       # –¢–µ—Å—Ç—ã –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ test_config.py          # –¢–µ—Å—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–≤–∫–ª—é—á–∞—è HTTPS)
‚îÇ   ‚îú‚îÄ‚îÄ test_database.py        # –¢–µ—Å—Ç—ã –ë–î (profiles)
‚îÇ   ‚îî‚îÄ‚îÄ test_interactions.py    # –¢–µ—Å—Ç—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π, –º–∞—Ç—á–µ–π –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚îú‚îÄ‚îÄ webapp/
‚îÇ   ‚îú‚îÄ‚îÄ css/                    # –°—Ç–∏–ª–∏ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ js/                     # JavaScript –ª–æ–≥–∏–∫–∞ (includes like/dislike handlers)
‚îÇ   ‚îî‚îÄ‚îÄ index.html              # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ WebApp
‚îú‚îÄ‚îÄ .dockerignore
‚îú‚îÄ‚îÄ .env.example                # –®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å HTTPS
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ alembic.ini                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Alembic
‚îú‚îÄ‚îÄ docker-compose.yml          # –ü—Ä–æ–¥–∞–∫—à–Ω —Å Traefik –∏ HTTPS
‚îú‚îÄ‚îÄ docker-compose.dev.yml      # –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –±–µ–∑ HTTPS
‚îú‚îÄ‚îÄ Dockerfile                  # –û–±—Ä–∞–∑ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ pytest.ini                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest
‚îú‚îÄ‚îÄ README.md                   # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ requirements.txt            # –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ requirements-dev.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –û—Ç–ª–∞–¥–∫–∞

### –ö–æ–º–∞–Ω–¥–∞ /analytics

–ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É `/analytics` –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏:

```
/analytics
```

**–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç**:
- üë• –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–≤—Å–µ–≥–æ, —Å—Ä–µ–¥–Ω–∏–π –≤–æ–∑—Ä–∞—Å—Ç, –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å)
- üöπüö∫ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–æ–ª—É
- üíë –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π (–º–∞—Ç—á–∏, –ª–∞–π–∫–∏, –¥–∏–∑–ª–∞–π–∫–∏, match rate)
- üìç –¢–æ–ø –ª–æ–∫–∞—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üéØ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–π –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞
- ‚ö° –ú–µ—Ç—Ä–∏–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (uptime, –∫–æ–º–∞–Ω–¥—ã, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è)

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**:
1. –û—Ç–∫—Ä–æ–π—Ç–µ —á–∞—Ç —Å –±–æ—Ç–æ–º –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/analytics`
3. –ü–æ–ª—É—á–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É —Å–∏—Å—Ç–µ–º—ã

### –ö–æ–º–∞–Ω–¥–∞ /debug

–ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –∫–æ–º–∞–Ω–¥—É `/debug` –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä—è–º–æ –≤ Telegram:

```
/debug
```

**–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç**:
- ‚úÖ –°—Ç–∞—Ç—É—Å –±–æ—Ç–∞ (ID, username)
- ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (WebApp URL, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
- üóÑÔ∏è –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ë–î (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ñ–∏–ª–µ–π, –º–∞—Ç—á–µ–π, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π)
- üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Å –º–∞—Å–∫–∏—Ä–æ–≤–∫–æ–π —Å–µ–∫—Ä–µ—Ç–æ–≤)
- üíª –°–∏—Å—Ç–µ–º–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (Python, –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, log level)

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**:
1. –û—Ç–∫—Ä–æ–π—Ç–µ —á–∞—Ç —Å –±–æ—Ç–æ–º –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/debug`
3. –ü–æ–ª—É—á–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –±–æ—Ç–∞

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –í—Å–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø–∞—Ä–æ–ª–∏, —Ç–æ–∫–µ–Ω—ã) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–∞—Å–∫–∏—Ä—É—é—Ç—Å—è.

### –ü—Ä–æ—Å–º–æ—Ç—Ä –õ–æ–≥–æ–≤

#### Docker Compose:

```bash
# –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker compose logs -f

# –¢–æ–ª—å–∫–æ –±–æ—Ç
docker compose logs -f bot

# –¢–æ–ª—å–∫–æ –ë–î
docker compose logs -f db

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
docker compose logs --tail=100 bot
```

#### –£—Ä–æ–≤–Ω–∏ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: **INFO**

–í–∫–ª—é—á–∏—Ç—å DEBUG:
```bash
# –í .env
DEBUG=true
```

–ò–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:
```bash
DEBUG=true docker compose up -d --build
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –°–æ—Å—Ç–æ—è–Ω–∏—è –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose ps

# –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
docker compose ps -a

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–∞–∑–µ –î–∞–Ω–Ω—ã—Ö

```bash
# –ß–µ—Ä–µ–∑ psql –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker compose exec db psql -U dating -d dating

# –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:
# \dt - —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü
# SELECT * FROM profiles; - –≤—Å–µ –ø—Ä–æ—Ñ–∏–ª–∏
# SELECT COUNT(*) FROM profiles; - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ñ–∏–ª–µ–π
```

### –¢–∏–ø–∏—á–Ω—ã–µ –ü—Ä–æ–±–ª–µ–º—ã –∏ –†–µ—à–µ–Ω–∏—è

#### 1. –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º**: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä `bot` –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
- –ù–µ–≤–µ—Ä–Ω—ã–π `BOT_TOKEN`
- –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
- –û—à–∏–±–∫–∏ –≤ –º–∏–≥—Ä–∞—Ü–∏—è—Ö

**–†–µ—à–µ–Ω–∏–µ**:
```bash
docker compose logs bot  # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker compose ps db     # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ë–î
```

#### 2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º**: `Cannot connect to database`, `password authentication failed`, –∏–ª–∏ `Database migration attempt X/5 failed`

**–ü—Ä–∏—á–∏–Ω—ã**:
1. –ü–∞—Ä–æ–ª—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ `.env` –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –ø–∞—Ä–æ–ª–µ–º, —Å –∫–æ—Ç–æ—Ä—ã–º –±—ã–ª–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –±–∞–∑–∞
2. –ü–∞—Ä–æ–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –±—ã–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã –≤ URL
3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤–∞ (—Ä–µ–¥–∫–æ, —Ç.–∫. –µ—Å—Ç—å health check)

**–ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã**:
PostgreSQL —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–∞—Ä–æ–ª—å –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ volume `postgres_data`. –ï—Å–ª–∏ –≤—ã –ø–æ–∑–∂–µ –∏–∑–º–µ–Ω–∏—Ç–µ `POSTGRES_PASSWORD` –≤ `.env` —Ñ–∞–π–ª–µ, –Ω–æ volume –æ—Å—Ç–∞–Ω–µ—Ç—Å—è —Å—Ç–∞—Ä—ã–º, —Ç–æ –ø–∞—Ä–æ–ª–∏ –Ω–µ –±—É–¥—É—Ç —Å–æ–≤–ø–∞–¥–∞—Ç—å.

**–†–µ—à–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ (–ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ GitHub Actions)**: 
–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–æ–ª—è –¥–µ–ø–ª–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Å—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã, –Ω–æ —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–º–µ–Ω–µ –ø–∞—Ä–æ–ª—è.

**–†–µ—à–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å healthcheck –ë–î
docker compose ps db

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ë–î
docker compose restart db

# –ï—Å–ª–∏ –ø–∞—Ä–æ–ª—å –∏–∑–º–µ–Ω–∏–ª—Å—è, –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Å –Ω—É–ª—è (–£–î–ê–õ–ò–¢ –í–°–ï –î–ê–ù–ù–´–ï)
docker compose down -v
docker compose up -d --build
```

**–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã**:
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ **–∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ-—Ü–∏—Ñ—Ä–æ–≤—ã–µ —Å–∏–º–≤–æ–ª—ã** (A-Z, a-z, 0-9) –¥–ª—è `POSTGRES_PASSWORD`
2. –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã (`@`, `:`, `/`, `!`, –∏ —Ç.–¥.) —Ç—Ä–µ–±—É—é—Ç URL-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –º–æ–≥—É—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
3. –°–∫—Ä–∏–ø—Ç `scripts/deploy.sh` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏
4. –ï—Å–ª–∏ –≤—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç–µ –ø–∞—Ä–æ–ª—å –≤—Ä—É—á–Ω—É—é, –∏–∑–±–µ–≥–∞–π—Ç–µ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å –≤ .env
grep POSTGRES_PASSWORD .env

# –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è —Å —ç—Ç–∏–º –ø–∞—Ä–æ–ª–µ–º
docker compose exec db psql -U dating -d dating
# –ï—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ —É–¥–∞–µ—Ç—Å—è - –ø–∞—Ä–æ–ª—å –Ω–µ–≤–µ—Ä–Ω—ã–π
```

#### 3. WebApp –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–°–∏–º–ø—Ç–æ–º**: 404 –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ**:
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `WEBAPP_URL` –≤ `.env`
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ nginx –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω: `docker compose ps webapp`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `8080`

#### 4. –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º**: –û—à–∏–±–∫–∏ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª–µ–π

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é
docker compose exec bot alembic upgrade head

# –ò–ª–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker compose up -d --build bot
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ Production

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–π —Å—Ç–µ–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å Prometheus, Grafana, Loki –∏ –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏.

#### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

```bash
# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
docker compose -f docker-compose.yml -f docker-compose.monitoring.yml up -d

# –î–æ—Å—Ç—É–ø –∫ –¥–∞—à–±–æ—Ä–¥–∞–º
# Grafana: http://localhost:3000 (admin/admin)
# Prometheus: http://localhost:9090
```

#### –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ

- **Prometheus** - —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ (CPU, –ø–∞–º—è—Ç—å, —Å–µ—Ç—å)
- **Grafana** - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –¥–∞—à–±–æ—Ä–¥—ã
- **Loki** - –∞–≥—Ä–µ–≥–∞—Ü–∏—è –ª–æ–≥–æ–≤
- **cAdvisor** - –º–µ—Ç—Ä–∏–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- **Node Exporter** - —Å–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- **Postgres Exporter** - –º–µ—Ç—Ä–∏–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **Analytics Module** - –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

#### –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

**–°–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU –∏ –ø–∞–º—è—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î
- –°–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
- –õ–æ–≥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–æ–∏—Å–∫–∞

**–ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏ (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏):**
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞ (start, matches, stats, analytics)
- –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (likes, dislikes, matches)
- –î–µ–π—Å—Ç–≤–∏—è —Å –ø—Ä–æ—Ñ–∏–ª—è–º–∏ (create, update, delete)
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- Match rate –∏ engagement rate

#### –î–∞—à–±–æ—Ä–¥—ã Grafana

1. **Dating App - Overview** - —Å–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
2. **Dating App - Business Metrics** - –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
   - –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –º–∞—Ç—á–µ–π
   - Match rate –∏ engagement rate
   - –ì—Ä–∞—Ñ–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –≤–æ –≤—Ä–µ–º–µ–Ω–∏
   - –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ —Ç–∏–ø–∞–º

#### –ê–ª–µ—Ä—Ç—ã

–ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã –Ω–∞:
- –ü–∞–¥–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –í—ã—Å–æ–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ (>90%)
- –í—ã—Å–æ–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ CPU (>80%)
- –ú–∞–ª–æ–µ –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ (<10%)
- –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –ë–î

–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [monitoring/README.md](monitoring/README.md)

---

## üîß –†–∞–±–æ—Ç–∞ —Å –ú–∏–≥—Ä–∞—Ü–∏—è–º–∏

### –°–æ–∑–¥–∞–Ω–∏–µ –ù–æ–≤–æ–π –ú–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –º–æ–¥–µ–ª—è—Ö
alembic revision --autogenerate -m "Add new field to profile"

# –†—É—á–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è
alembic revision -m "Custom migration"
```

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ú–∏–≥—Ä–∞—Ü–∏–π

```bash
# –î–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏
alembic upgrade head

# –î–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ä–µ–≤–∏–∑–∏–∏
alembic upgrade <revision_id>

# –ù–∞ –æ–¥–Ω—É –≤–ø–µ—Ä–µ–¥
alembic upgrade +1
```

### –û—Ç–∫–∞—Ç –ú–∏–≥—Ä–∞—Ü–∏–π

```bash
# –ù–∞ –æ–¥–Ω—É –Ω–∞–∑–∞–¥
alembic downgrade -1

# –î–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ä–µ–≤–∏–∑–∏–∏
alembic downgrade <revision_id>

# –ö —Å–∞–º–æ–º—É –Ω–∞—á–∞–ª—É (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
alembic downgrade base
```

### –ò—Å—Ç–æ—Ä–∏—è –ú–∏–≥—Ä–∞—Ü–∏–π

```bash
# –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è
alembic current

# –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –º–∏–≥—Ä–∞—Ü–∏–π
alembic history

# –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è
alembic history --verbose
```

---

## üìù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ù–æ–≤–æ–π –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

1. **–°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É**:
   ```bash
   git checkout -b feature/new-feature
   ```

2. **–í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** –≤ –∫–æ–¥

3. **–î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç—ã** –≤ `tests/`

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã**:
   ```bash
   python -m pytest
   ```

5. **–°–æ–∑–¥–∞–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏** (–µ—Å–ª–∏ –º–µ–Ω—è–ª–∏ –º–æ–¥–µ–ª–∏):
   ```bash
   alembic revision --autogenerate -m "Description"
   ```

6. **Commit –∏ Push**:
   ```bash
   git add .
   git commit -m "Add new feature"
   git push origin feature/new-feature
   ```

7. **–°–æ–∑–¥–∞–π—Ç–µ Pull Request** –Ω–∞ GitHub

8. **CI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**:
   - –ó–∞–ø—É—Å—Ç–∏—Ç —Ç–µ—Å—Ç—ã
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç —Å–±–æ—Ä–∫—É Docker
   - –ó–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç merge –µ—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏

### Code Style

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
- Type hints –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
- Docstrings –¥–ª—è –º–æ–¥—É–ª–µ–π –∏ –∫–ª–∞—Å—Å–æ–≤
- Async/await –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- SQLAlchemy 2.0 —Å—Ç–∏–ª—å (async ORM)

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π.

---

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –û—Ç–ª–∞–¥–∫–∞](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–æ—Ç–ª–∞–¥–∫–∞)
2. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ Issues –Ω–∞ GitHub
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π Issue —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º—ã –∏ –ª–æ–≥–∞–º–∏

---

**–£—Å–ø–µ—à–Ω—ã—Ö –∑–Ω–∞–∫–æ–º—Å—Ç–≤! ‚ù§Ô∏è**
