# üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

## –û–±–∑–æ—Ä

Dating Bot - —ç—Ç–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –Ω–∞ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö —Å –ø–æ–ª–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π CI/CD.

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        External Layer                            ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                      ‚îÇ
‚îÇ  ‚îÇ   Telegram   ‚îÇ         ‚îÇ  Let's       ‚îÇ                      ‚îÇ
‚îÇ  ‚îÇ     Bot API  ‚îÇ         ‚îÇ  Encrypt CA  ‚îÇ                      ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                      ‚îÇ
‚îÇ         ‚îÇ                        ‚îÇ                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ                        ‚îÇ
          ‚îÇ HTTPS (443)            ‚îÇ ACME (80/443)
          ‚îÇ                        ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     Reverse Proxy Layer                          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îÇ
‚îÇ  ‚îÇ                    Traefik                              ‚îÇ     ‚îÇ
‚îÇ  ‚îÇ  - SSL Termination                                      ‚îÇ     ‚îÇ
‚îÇ  ‚îÇ  - Auto HTTPS with Let's Encrypt                        ‚îÇ     ‚îÇ
‚îÇ  ‚îÇ  - HTTP ‚Üí HTTPS redirect                                ‚îÇ     ‚îÇ
‚îÇ  ‚îÇ  - Request routing                                      ‚îÇ     ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ                ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ        ‚îÇ     ‚îÇ           Application Layer                        ‚îÇ
‚îÇ WebApp ‚îÇ     ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îÇ
‚îÇ (nginx)‚îÇ     ‚îÇ  ‚îÇ       Telegram Bot (Python)               ‚îÇ     ‚îÇ
‚îÇ        ‚îÇ     ‚îÇ  ‚îÇ  - aiogram 3.x framework                  ‚îÇ     ‚îÇ
‚îÇ        ‚îÇ     ‚îÇ  ‚îÇ  - Command handlers                       ‚îÇ     ‚îÇ
‚îÇ        ‚îÇ     ‚îÇ  ‚îÇ  - WebApp data processing                 ‚îÇ     ‚îÇ
‚îÇ        ‚îÇ     ‚îÇ  ‚îÇ  - Matching algorithm                     ‚îÇ     ‚îÇ
‚îÇ        ‚îÇ     ‚îÇ  ‚îÇ  - Notification system                    ‚îÇ     ‚îÇ
‚îÇ        ‚îÇ     ‚îÇ  ‚îÇ  - Analytics engine                       ‚îÇ     ‚îÇ
‚îÇ        ‚îÇ     ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ                ‚îÇ                                   ‚îÇ
               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                ‚îÇ
                                ‚îÇ asyncpg
                                ‚îÇ
               ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
               ‚îÇ              Data Layer                            ‚îÇ
               ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îÇ
               ‚îÇ  ‚îÇ       PostgreSQL 15                       ‚îÇ     ‚îÇ
               ‚îÇ  ‚îÇ  - profiles (users)                       ‚îÇ     ‚îÇ
               ‚îÇ  ‚îÇ  - user_interactions (likes/dislikes)     ‚îÇ     ‚îÇ
               ‚îÇ  ‚îÇ  - matches (mutual likes)                 ‚îÇ     ‚îÇ
               ‚îÇ  ‚îÇ  - user_settings (preferences)            ‚îÇ     ‚îÇ
               ‚îÇ  ‚îÇ  Named volume: postgres_data              ‚îÇ     ‚îÇ
               ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ
               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚îÇ            Monitoring Layer (Optional)                  ‚îÇ
          ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê            ‚îÇ
          ‚îÇ  ‚îÇPrometheus‚îÇ  ‚îÇ  Grafana ‚îÇ  ‚îÇ   Loki    ‚îÇ            ‚îÇ
          ‚îÇ  ‚îÇ (Metrics)‚îÇ  ‚îÇ(Dashbrd) ‚îÇ  ‚îÇ  (Logs)   ‚îÇ            ‚îÇ
          ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò            ‚îÇ
          ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê            ‚îÇ
          ‚îÇ  ‚îÇ cAdvisor ‚îÇ  ‚îÇ   Node   ‚îÇ  ‚îÇ Postgres  ‚îÇ            ‚îÇ
          ‚îÇ  ‚îÇ(Cntnr)   ‚îÇ  ‚îÇ Exporter ‚îÇ  ‚îÇ Exporter  ‚îÇ            ‚îÇ
          ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò            ‚îÇ
          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. Traefik (Reverse Proxy)

**–†–æ–ª—å**: –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–§—É–Ω–∫—Ü–∏–∏**:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –æ—Ç Let's Encrypt
- HTTP ‚Üí HTTPS —Ä–µ–¥–∏—Ä–µ–∫—Ç
- –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ WebApp
- Health checks
- –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è Prometheus

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**:
- –ü–æ—Ä—Ç—ã: 80 (HTTP), 443 (HTTPS)
- Volume: `traefik_certs` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- –ú–µ—Ç–æ–¥ –≤–∞–ª–∏–¥–∞—Ü–∏–∏: TLS Challenge (–ø–æ—Ä—Ç 443)

**Production Only**: –í dev —Ä–µ–∂–∏–º–µ (docker-compose.dev.yml) Traefik –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

---

### 2. Telegram Bot

**–†–æ–ª—å**: –û—Å–Ω–æ–≤–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫**:
- Python 3.11+
- aiogram 3.x (async Telegram Bot framework)
- SQLAlchemy 2.0 (async ORM)
- asyncpg (PostgreSQL driver)
- Alembic (database migrations)

**–ú–æ–¥—É–ª–∏**:

#### `bot/main.py`
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ (`/start`, `/matches`, `/stats`, `/analytics`)
- –ü—Ä–∏—ë–º –¥–∞–Ω–Ω—ã—Ö –∏–∑ WebApp
- –ê–ª–≥–æ—Ä–∏—Ç–º –º–∞—Ç—á–∏–Ω–≥–∞
- –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

#### `bot/db.py`
- –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (ProfileModel, UserInteractionModel, MatchModel, UserSettingsModel)
- –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
- –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π

#### `bot/config.py`
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ BOT_TOKEN
- –ü–∞—Ä—Å–∏–Ω–≥ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### `bot/analytics.py`
- –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ê–≥—Ä–µ–≥–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –†–∞—Å—á–µ—Ç engagement rates

#### `bot/security.py`
- Rate limiting
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞

#### `bot/cache.py`
- In-memory –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π
- TTL —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î

**–ê–ª–≥–æ—Ä–∏—Ç–º –º–∞—Ç—á–∏–Ω–≥–∞**:

1. **–í–∑–∞–∏–º–Ω—ã–π –ª–∞–π–∫**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –ª–∞–π–∫–Ω—É—Ç—å –¥—Ä—É–≥ –¥—Ä—É–≥–∞
2. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤**: 
   - Weighted scoring –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±—â–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤
   - 40% –≤–µ—Å–∞ - —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤
3. **–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –±–ª–∏–∑–æ—Å—Ç—å**:
   - 30% –≤–µ—Å–∞ - –æ–¥–∏–Ω–∞–∫–æ–≤–∞—è –ª–æ–∫–∞—Ü–∏—è
4. **–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ü–µ–ª–µ–π**:
   - 20% –≤–µ—Å–∞ - —Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Ü–µ–ª–∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞
5. **–í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**:
   - 10% –≤–µ—Å–∞ - –±–ª–∏–∑–∫–∏–π –≤–æ–∑—Ä–∞—Å—Ç (¬±5 –ª–µ—Ç)

**–ü—Ä–æ—Ü–µ—Å—Å –º–∞—Ç—á–∏–Ω–≥–∞**:
```
User A likes User B
       ‚Üì
Check if User B liked User A
       ‚Üì
If YES ‚Üí Calculate compatibility score
       ‚Üì
If score > threshold ‚Üí Create match
       ‚Üì
Send notifications to both users
```

---

### 3. PostgreSQL Database

**–†–æ–ª—å**: –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö

**–í–µ—Ä—Å–∏—è**: PostgreSQL 15 Alpine (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ä–∞–∑)

**–°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö**:

#### –¢–∞–±–ª–∏—Ü–∞ `profiles`
```sql
- id (SERIAL PRIMARY KEY)
- user_id (BIGINT UNIQUE) -- Telegram user ID
- name (VARCHAR)
- age (INTEGER)
- gender (VARCHAR)
- preference (VARCHAR) -- –∏—â—É: male/female/any
- bio (TEXT)
- location (VARCHAR)
- interests (JSONB) -- –º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫
- goal (VARCHAR) -- —Ü–µ–ª—å –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞
- photo_file_id (VARCHAR)
- photo_url (VARCHAR)
- created_at (TIMESTAMP)
- updated_at (TIMESTAMP)

INDEX: idx_user_id ON user_id
INDEX: idx_gender_preference ON (gender, preference)
INDEX: idx_location ON location
INDEX: idx_interests ON interests USING GIN
```

#### –¢–∞–±–ª–∏—Ü–∞ `user_interactions`
```sql
- id (SERIAL PRIMARY KEY)
- from_user_id (BIGINT) -- –∫—Ç–æ –æ—Ü–µ–Ω–∏–ª
- to_user_id (BIGINT) -- –∫–æ–≥–æ –æ—Ü–µ–Ω–∏–ª–∏
- action (VARCHAR) -- 'like' –∏–ª–∏ 'dislike'
- created_at (TIMESTAMP)

INDEX: idx_from_user ON from_user_id
INDEX: idx_to_user ON to_user_id
INDEX: idx_from_to ON (from_user_id, to_user_id)
UNIQUE CONSTRAINT: (from_user_id, to_user_id)
```

#### –¢–∞–±–ª–∏—Ü–∞ `matches`
```sql
- id (SERIAL PRIMARY KEY)
- user1_id (BIGINT)
- user2_id (BIGINT)
- compatibility_score (FLOAT)
- matched_at (TIMESTAMP)

INDEX: idx_user1 ON user1_id
INDEX: idx_user2 ON user2_id
UNIQUE CONSTRAINT: (user1_id, user2_id)
```

#### –¢–∞–±–ª–∏—Ü–∞ `user_settings`
```sql
- id (SERIAL PRIMARY KEY)
- user_id (BIGINT UNIQUE)
- min_age (INTEGER)
- max_age (INTEGER)
- max_distance (INTEGER)
- show_online_status (BOOLEAN)
- allow_notifications (BOOLEAN)

INDEX: idx_user_settings ON user_id
```

**–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**:
- Named volume: `postgres_data`
- –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–æ–ª—è –ë–î —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ volume

**Backup —Å—Ç—Ä–∞—Ç–µ–≥–∏—è**:
```bash
# –°–æ–∑–¥–∞—Ç—å backup
docker compose exec db pg_dump -U dating dating > backup.sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ backup
docker compose exec -T db psql -U dating dating < backup.sql
```

---

### 4. WebApp (nginx)

**–†–æ–ª—å**: –°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Telegram –¥–ª—è dating app

**–í–µ—Ä—Å–∏—è**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–æ (2024) —Å –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–º–∏ best practices

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞**:
```
webapp/
‚îú‚îÄ‚îÄ README.md           # –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ index.html          # –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π HTML5 (—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π)
‚îú‚îÄ‚îÄ css/
‚îÇ   ‚îî‚îÄ‚îÄ style.css       # –ú–æ–¥—É–ª—å–Ω—ã–π CSS —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
‚îî‚îÄ‚îÄ js/
    ‚îî‚îÄ‚îÄ app.js          # –ú–æ–¥—É–ª—å–Ω—ã–π ES6+ JavaScript
```

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- ‚úÖ **Card-based swipe interface** - –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è dating apps
- ‚úÖ **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ UI/logic/data
- ‚úÖ **Haptic feedback** - –Ω–∞—Ç–∏–≤–Ω—ã–π –æ–ø—ã—Ç –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
- ‚úÖ **Offline queue** - –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
- ‚úÖ **Theme integration** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ Telegram theme
- ‚úÖ **Accessibility** - WCAG 2.1 AA compliant
- ‚úÖ **Mobile-first** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- ‚úÖ **No build step** - —á–∏—Å—Ç—ã–π HTML/CSS/JS

**–≠–∫—Ä–∞–Ω—ã**:
1. Profile Form - —Å–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–∫–µ—Ç—ã
2. Discover - –∫–∞—Ä—Ç–æ—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Å–≤–∞–π–ø–æ–≤
3. Matches - —Å–ø–∏—Å–æ–∫ –≤–∑–∞–∏–º–Ω—ã—Ö —Å–∏–º–ø–∞—Ç–∏–π

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**:
- –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ `tg.sendData()` (Telegram WebApp SDK)
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º `webapp_handler` –≤ –±–æ—Ç–µ
- Queuing –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π

**–î–æ—Å—Ç—É–ø**:
- Production: https://your-domain.com
- Development: http://localhost:8080

**–ü–æ–¥—Ä–æ–±–Ω–µ–µ**: –°–º. [webapp/README.md](../webapp/README.md)

---

### 5. Monitoring Stack (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ profile:
```bash
docker compose --profile monitoring up -d
```

#### Prometheus
- **–ü–æ—Ä—Ç**: 9090
- **–†–æ–ª—å**: –°–±–æ—Ä –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
- **Retention**: 30 –¥–Ω–µ–π
- **Targets**: cAdvisor, Node Exporter, Postgres Exporter, Traefik

#### Grafana
- **–ü–æ—Ä—Ç**: 3000
- **–†–æ–ª—å**: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –¥–∞—à–±–æ—Ä–¥—ã
- **Credentials**: admin/admin (–∏–∑–º–µ–Ω–∏—Ç–µ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ)
- **Datasources**: Prometheus, Loki

#### Loki + Promtail
- **–ü–æ—Ä—Ç**: 3100
- **–†–æ–ª—å**: –ê–≥—Ä–µ–≥–∞—Ü–∏—è –ª–æ–≥–æ–≤
- **Retention**: 30 –¥–Ω–µ–π
- **Sources**: Docker containers, system logs

#### Exporters
- **cAdvisor**: –ú–µ—Ç—Ä–∏–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (–ø–æ—Ä—Ç 8081)
- **Node Exporter**: –°–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (–ø–æ—Ä—Ç 9100)
- **Postgres Exporter**: –ú–µ—Ç—Ä–∏–∫–∏ –ë–î (–ø–æ—Ä—Ç 9187)

---

## Data Flow

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è

```
User ‚Üí Telegram Bot ‚Üí /start command
        ‚Üì
Bot ‚Üí Send inline keyboard with WebApp button
        ‚Üì
User ‚Üí Click button ‚Üí Open WebApp (nginx)
        ‚Üì
User ‚Üí Fill form ‚Üí Submit
        ‚Üì
WebApp ‚Üí Send data via Telegram WebApp API
        ‚Üì
Bot ‚Üí Receive WebAppData ‚Üí Validate
        ‚Üì
Bot ‚Üí Save to PostgreSQL (profiles table)
        ‚Üì
Bot ‚Üí Send confirmation message
```

### 2. –õ–∞–π–∫ –∏ –º–∞—Ç—á–∏–Ω–≥

```
User A ‚Üí Bot ‚Üí View User B profile
        ‚Üì
User A ‚Üí Like User B
        ‚Üì
Bot ‚Üí Save interaction (user_interactions table)
        ‚Üì
Bot ‚Üí Check if User B liked User A
        ‚Üì
If YES:
    ‚îú‚Üí Calculate compatibility score
    ‚îú‚Üí Create match (matches table)
    ‚îú‚Üí Notify User A
    ‚îî‚Üí Notify User B
```

### 3. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞

```
Admin ‚Üí /analytics command
        ‚Üì
Bot ‚Üí Query aggregated data from DB
        ‚Üì
Bot ‚Üí Calculate metrics (DAU, match rate, etc.)
        ‚Üì
Bot ‚Üí Format and send report
```

---

## Deployment Flow

### Local Development
```
Developer ‚Üí docker compose -f docker-compose.dev.yml up
            ‚Üì
Docker ‚Üí Pull base images (postgres, nginx)
            ‚Üì
Docker ‚Üí Build bot image from Dockerfile
            ‚Üì
Docker ‚Üí Start containers (db ‚Üí bot ‚Üí webapp)
            ‚Üì
Bot ‚Üí Run migrations (Alembic)
            ‚Üì
Bot ‚Üí Start polling Telegram API
            ‚Üì
Ready for testing ‚úì
```

### Production Deployment (CI/CD)
```
Developer ‚Üí git push origin main
            ‚Üì
GitHub Actions ‚Üí Trigger deploy workflow
            ‚Üì
Workflow ‚Üí Validate secrets
            ‚Üì
Workflow ‚Üí Setup SSH connection
            ‚Üì
Workflow ‚Üí Prepare server (install Docker if needed)
            ‚Üì
Workflow ‚Üí Upload project files via rsync
            ‚Üì
Workflow ‚Üí Generate .env from secrets
            ‚Üì
Workflow ‚Üí Validate configuration
            ‚Üì
Server ‚Üí docker compose --profile monitoring up -d --build
            ‚Üì
Server ‚Üí Pull images & build bot
            ‚Üì
Server ‚Üí Start containers (Traefik, DB, Bot, WebApp, Monitoring)
            ‚Üì
Server ‚Üí Run migrations
            ‚Üì
Workflow ‚Üí Health checks
            ‚Üì
Production ready ‚úì
```

---

## Scaling Considerations

### Vertical Scaling
- –£–≤–µ–ª–∏—á–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (memory, CPU limits)
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å SQL –∑–∞–ø—Ä–æ—Å—ã –∏ –∏–Ω–¥–µ–∫—Å—ã
- –í–∫–ª—é—á–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (Redis)

### Horizontal Scaling
**–¢–µ–∫—É—â–µ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ**: –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ single-instance —Ä–µ–∂–∏–º–µ

**–î–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è**:
1. Redis –¥–ª—è shared state
2. Message queue (RabbitMQ) –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
3. Stateless bot instances
4. Load balancer –ø–µ—Ä–µ–¥ –±–æ—Ç–∞–º–∏
5. Distributed session storage

**–°–º. —Ç–∞–∫–∂–µ**: [ROADMAP.md](../ROADMAP.md) - —Å–µ–∫—Ü–∏—è "–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ"

---

## Security

### 1. Network Security
- –í—Å–µ –≤–Ω–µ—à–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ HTTPS (TLS 1.2+)
- –ó–∞–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã –ë–î (–¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –∏–∑ Docker network)
- Rate limiting –≤ –±–æ—Ç–µ

### 2. Data Security
- –•—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- SQL injection –∑–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ SQLAlchemy ORM
- XSS –∑–∞—â–∏—Ç–∞ –≤ WebApp

### 3. Secrets Management
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ .env (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è)
- GitHub Secrets –¥–ª—è CI/CD
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

### 4. Access Control
- Telegram user_id –∫–∞–∫ –ø–µ—Ä–≤–∏—á–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- –ù–µ—Ç –ø—É–±–ª–∏—á–Ω–æ–≥–æ API (—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Telegram)
- Admin –∫–æ–º–∞–Ω–¥—ã –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª—å—Ü—É –±–æ—Ç–∞

---

## Performance

### Database
- –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª—è—Ö
- Connection pooling —á–µ—Ä–µ–∑ SQLAlchemy
- Async queries –¥–ª—è –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### Bot
- In-memory –∫—ç—à –ø—Ä–æ—Ñ–∏–ª–µ–π (TTL 300s)
- Batch processing –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- Async/await –¥–ª—è –≤—Å–µ—Ö I/O –æ–ø–µ—Ä–∞—Ü–∏–π

### WebApp
- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã —Å–∂–∞—Ç—ã gzip (nginx)
- CDN –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å CloudFlare)
- –ú–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ JS/CSS

---

## Monitoring and Observability

### –ú–µ—Ç—Ä–∏–∫–∏ (Prometheus)
- Request rate, error rate, duration
- Container resources (CPU, Memory, Network)
- Database connections, query performance
- Custom business metrics (matches, likes, users)

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (Loki)
- Structured logging (JSON format)
- Log levels: DEBUG, INFO, WARNING, ERROR, CRITICAL
- Centralized log aggregation
- Full-text search

### Alerting (Prometheus Alerts)
- Container down
- High memory/CPU usage
- Database connection issues
- Error rate spikes

### Dashboards (Grafana)
- System overview (all services)
- Business metrics (users, matches, engagement)
- Database performance
- Container resources

---

## Disaster Recovery

### Backup Strategy
```bash
# Database backup (daily cron recommended)
docker compose exec db pg_dump -U dating dating | gzip > backup-$(date +%Y%m%d).sql.gz

# Volume backup
docker run --rm -v dating_postgres_data:/data -v $(pwd):/backup alpine tar czf /backup/postgres_data.tar.gz /data
```

### Recovery Procedure
```bash
# Restore database
gunzip < backup-20240101.sql.gz | docker compose exec -T db psql -U dating dating

# Restore volume
docker run --rm -v dating_postgres_data:/data -v $(pwd):/backup alpine tar xzf /backup/postgres_data.tar.gz -C /
```

### RTO/RPO
- **RTO** (Recovery Time Objective): < 15 –º–∏–Ω—É—Ç
- **RPO** (Recovery Point Objective): < 24 —á–∞—Å–∞ (daily backups)

---

## Future Architecture

–°–º. [ROADMAP.md](../ROADMAP.md) –¥–ª—è –ø–ª–∞–Ω–∏—Ä—É–µ–º—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π:
- Microservices separation
- Event-driven architecture
- GraphQL API
- Mobile app backends
- Redis caching layer
- CDN integration

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è –∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏—è

### –ü–æ—á–µ–º—É aiogram?
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π async framework
- Type hints support
- –û—Ç–ª–∏—á–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- Active community

### –ü–æ—á–µ–º—É PostgreSQL?
- JSONB –¥–ª—è –≥–∏–±–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (interests)
- Robust –∏ production-ready
- –û—Ç–ª–∏—á–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- GIN –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è JSONB

### –ü–æ—á–µ–º—É Docker Compose?
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- –õ–µ–≥–∫–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ Kubernetes
- Built-in networking

### –ü–æ—á–µ–º—É Traefik?
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π HTTPS
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- Docker-native
- Excellent –¥–ª—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤

---

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞**: 2024-12-21
