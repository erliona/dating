<template>
  <div class="step-additional">
    <div class="step-header">
      <h2>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
      <p>–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –±–æ–ª—å—à–µ –æ —Å–µ–±–µ (–≤—Å–µ –ø–æ–ª—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ)</p>
    </div>

    <div class="step-content">
      <div class="form-section">
        <h3>–û—Å–Ω–æ–≤–Ω–æ–µ</h3>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">–†–æ—Å—Ç (—Å–º)</label>
            <input 
              v-model.number="formData.height_cm" 
              type="number" 
              placeholder="170"
              min="120"
              max="220"
              class="form-input"
            />
          </div>
          <div class="form-group">
            <label class="form-label">–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</label>
            <select v-model="formData.education" class="form-select">
              <option value="">–í—ã–±–µ—Ä–∏—Ç–µ</option>
              <option value="school">–°—Ä–µ–¥–Ω–µ–µ</option>
              <option value="college">–°—Ä–µ–¥–Ω–µ–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ</option>
              <option value="university">–í—ã—Å—à–µ–µ</option>
              <option value="postgraduate">–ê—Å–ø–∏—Ä–∞–Ω—Ç—É—Ä–∞</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">–ü—Ä–æ—Ñ–µ—Å—Å–∏—è</label>
          <input 
            v-model="formData.profession" 
            type="text" 
            placeholder="–í–∞—à–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏—è"
            class="form-input"
          />
        </div>
        <div class="form-group">
          <label class="form-label">–Ø–∑—ã–∫–∏</label>
          <input 
            v-model="formData.languages" 
            type="text" 
            placeholder="–†—É—Å—Å–∫–∏–π, English, Deutsch"
            class="form-input"
          />
        </div>
      </div>

      <div class="form-section">
        <h3>–°–µ–º—å—è –∏ –¥–µ—Ç–∏</h3>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">–î–µ—Ç–∏</label>
            <select v-model="formData.has_children" class="form-select">
              <option value="">–ù–µ —É–∫–∞–∑–∞–Ω–æ</option>
              <option :value="true">–ï—Å—Ç—å</option>
              <option :value="false">–ù–µ—Ç</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">–•–æ—á—É –¥–µ—Ç–µ–π</label>
            <select v-model="formData.wants_children" class="form-select">
              <option value="">–ù–µ —É–∫–∞–∑–∞–Ω–æ</option>
              <option :value="true">–î–∞</option>
              <option :value="false">–ù–µ—Ç</option>
            </select>
          </div>
        </div>
      </div>

      <div class="form-section">
        <h3>–ü—Ä–∏–≤—ã—á–∫–∏</h3>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">–ö—É—Ä–µ–Ω–∏–µ</label>
            <select v-model="formData.smoking" class="form-select">
              <option value="">–ù–µ —É–∫–∞–∑–∞–Ω–æ</option>
              <option value="never">–ù–∏–∫–æ–≥–¥–∞</option>
              <option value="occasionally">–ò–Ω–æ–≥–¥–∞</option>
              <option value="regularly">–†–µ–≥—É–ª—è—Ä–Ω–æ</option>
              <option value="quit">–ë—Ä–æ—Å–∏–ª(–∞)</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">–ê–ª–∫–æ–≥–æ–ª—å</label>
            <select v-model="formData.drinking" class="form-select">
              <option value="">–ù–µ —É–∫–∞–∑–∞–Ω–æ</option>
              <option value="never">–ù–∏–∫–æ–≥–¥–∞</option>
              <option value="occasionally">–ò–Ω–æ–≥–¥–∞</option>
              <option value="regularly">–†–µ–≥—É–ª—è—Ä–Ω–æ</option>
              <option value="quit">–ë—Ä–æ—Å–∏–ª(–∞)</option>
            </select>
          </div>
        </div>
      </div>

      <div class="optional-note">
        <p>üí° –í—Å–µ –ø–æ–ª—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ - –∑–∞–ø–æ–ª–Ω—è–π—Ç–µ —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –æ —Å–µ–±–µ</p>
      </div>
    </div>

    <div class="step-actions">
      <Button 
        variant="outline" 
        size="lg" 
        @click="handleBack"
        fullWidth
      >
        –ù–∞–∑–∞–¥
      </Button>
      <Button 
        variant="primary" 
        size="lg" 
        @click="handleNext"
        fullWidth
      >
        –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
      </Button>
    </div>
  </div>
</template>

<script setup>
import { ref, watch } from 'vue'
import Button from '../common/Button.vue'

const emit = defineEmits(['next', 'back', 'update-data'])

const formData = ref({
  height_cm: null,
  education: '',
  profession: '',
  languages: '',
  has_children: null,
  wants_children: null,
  smoking: '',
  drinking: ''
})

const handleNext = () => {
  emit('update-data', formData.value)
  emit('next')
}

const handleBack = () => {
  emit('back')
}

// Watch for changes and emit updates
watch(formData, (newData) => {
  emit('update-data', newData)
}, { deep: true })
</script>

<style scoped>
.step-additional {
  display: flex;
  flex-direction: column;
  height: 100%;
  padding: var(--spacing-md);
}

.step-header {
  text-align: center;
  margin-bottom: var(--spacing-md);
}

.step-header h2 {
  font-size: var(--font-size-2xl);
  font-weight: var(--font-weight-bold);
  margin: 0 0 var(--spacing-sm) 0;
  color: var(--text-primary);
}

.step-header p {
  font-size: var(--font-size-md);
  color: var(--text-secondary);
  margin: 0;
}

.step-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: var(--spacing-lg);
  overflow-y: auto;
}

.form-section {
  background-color: var(--bg-secondary);
  padding: var(--spacing-md);
  border-radius: var(--border-radius);
}

.form-section h3 {
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-semibold);
  margin: 0 0 var(--spacing-md) 0;
  color: var(--text-primary);
}

.form-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--spacing-md);
  margin-bottom: var(--spacing-md);
}

.form-row:last-child {
  margin-bottom: 0;
}

.form-group {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-xs);
}

.form-label {
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-medium);
  color: var(--text-primary);
}

.form-input,
.form-select {
  width: 100%;
  padding: var(--spacing-sm) var(--spacing-md);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  font-size: var(--font-size-md);
  background-color: white;
  transition: border-color 0.2s ease;
}

.form-input:focus,
.form-select:focus {
  outline: none;
  border-color: var(--primary-color);
}

.form-input::placeholder {
  color: var(--text-secondary);
}

.optional-note {
  text-align: center;
  padding: var(--spacing-md);
  background-color: rgba(var(--primary-rgb), 0.1);
  border-radius: var(--border-radius);
  border: 1px solid rgba(var(--primary-rgb), 0.2);
}

.optional-note p {
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
  margin: 0;
}

.step-actions {
  display: flex;
  gap: var(--spacing-md);
  margin-top: var(--spacing-md);
  padding-top: var(--spacing-md);
  border-top: 1px solid var(--border-color);
}

.step-actions .btn {
  flex: 1;
}

@media (max-width: 480px) {
  .form-row {
    grid-template-columns: 1fr;
  }
}
</style>