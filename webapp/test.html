<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini App Test Page</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .test-section {
            padding: 20px;
            margin: 20px 0;
            background: var(--tg-theme-secondary-bg-color);
            border-radius: 12px;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 8px;
            font-family: monospace;
            font-size: 14px;
        }
        .test-pass {
            background: #4caf5020;
            border: 1px solid #4caf50;
            color: #4caf50;
        }
        .test-fail {
            background: #f4433620;
            border: 1px solid #f44336;
            color: #f44336;
        }
        .test-info {
            background: #2481cc20;
            border: 1px solid #2481cc;
            color: #2481cc;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Mini App Test Page</h1>
        <p>–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Telegram WebApp API</p>
        
        <div class="test-section">
            <h2>SDK Status</h2>
            <div id="sdk-test"></div>
        </div>
        
        <div class="test-section">
            <h2>Theme Variables</h2>
            <div id="theme-test"></div>
        </div>
        
        <div class="test-section">
            <h2>UI Components</h2>
            <div id="ui-test"></div>
        </div>
        
        <div class="test-section">
            <h2>Platform Info</h2>
            <div id="platform-test"></div>
        </div>
    </div>
    
    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- App Scripts -->
    <script src="js/app.js"></script>
    
    <script>
        // Run tests after page load
        window.addEventListener('load', () => {
            runTests();
        });
        
        function addResult(containerId, message, type = 'info') {
            const container = document.getElementById(containerId);
            const div = document.createElement('div');
            div.className = `test-result test-${type}`;
            div.textContent = message;
            container.appendChild(div);
        }
        
        function runTests() {
            // Test 1: SDK Loading
            if (window.Telegram && window.Telegram.WebApp) {
                addResult('sdk-test', '‚úì Telegram WebApp SDK loaded', 'pass');
                addResult('sdk-test', `Version: ${window.Telegram.WebApp.version}`, 'info');
            } else {
                addResult('sdk-test', '‚úó Telegram WebApp SDK not loaded', 'fail');
                addResult('sdk-test', 'Note: This is expected when testing in browser', 'info');
            }
            
            // Test 2: Theme Variables
            const root = getComputedStyle(document.documentElement);
            const themeVars = [
                '--tg-theme-bg-color',
                '--tg-theme-text-color',
                '--tg-theme-button-color',
                '--tg-viewport-height'
            ];
            
            themeVars.forEach(varName => {
                const value = root.getPropertyValue(varName).trim();
                if (value) {
                    addResult('theme-test', `‚úì ${varName}: ${value}`, 'pass');
                } else {
                    addResult('theme-test', `‚úó ${varName} not set`, 'fail');
                }
            });
            
            // Test 3: UI Components
            if (tg) {
                addResult('ui-test', '‚úì MainButton API available', 'pass');
                addResult('ui-test', '‚úì BackButton API available', 'pass');
                addResult('ui-test', '‚úì HapticFeedback API available', 'pass');
                
                // Test MainButton
                try {
                    tg.MainButton.setText('Test Button');
                    addResult('ui-test', '‚úì MainButton.setText() works', 'pass');
                } catch (e) {
                    addResult('ui-test', `‚úó MainButton error: ${e.message}`, 'fail');
                }
            } else {
                addResult('ui-test', '‚úó Telegram WebApp not initialized', 'fail');
            }
            
            // Test 4: Platform Info
            if (tg) {
                const info = getPlatformInfo();
                if (info) {
                    Object.entries(info).forEach(([key, value]) => {
                        addResult('platform-test', `${key}: ${value}`, 'info');
                    });
                } else {
                    addResult('platform-test', '‚úó Could not get platform info', 'fail');
                }
            } else {
                addResult('platform-test', 'Platform: Browser (not Telegram)', 'info');
                addResult('platform-test', 'User Agent: ' + navigator.userAgent, 'info');
            }
        }
    </script>
</body>
</html>
