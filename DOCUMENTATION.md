# üíï Dating Telegram Mini App - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìñ –û–±–∑–æ—Ä

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –∫–∞–∫ Telegram Mini App. –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏, –∏—Å–∫–∞—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤, —Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫–∏ –∏ –æ–±—â–∞—Ç—å—Å—è —Å —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è–º–∏.

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**Dating Mini App** - —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤, –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤ Telegram:

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üíë **–ü–æ–∏—Å–∫ –ø–∞—Ä—Ç–Ω–µ—Ä–∞** - –ø—Ä–æ—Å–º–æ—Ç—Ä –∞–Ω–∫–µ—Ç —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö
- ‚ù§Ô∏è **–°–∏—Å—Ç–µ–º–∞ –ª–∞–π–∫–æ–≤** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ—è–≤–∏—Ç—å —Å–∏–º–ø–∞—Ç–∏—é –∏–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
- üéØ **–ú–∞—Ç—á–∏–Ω–≥** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–≤—è–∑–∏ –ø—Ä–∏ –≤–∑–∞–∏–º–Ω–æ–π —Å–∏–º–ø–∞—Ç–∏–∏
- üìç **–ü–æ–∏—Å–∫ –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏** - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
- üîê **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞ 18+, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å—é –¥–∞–Ω–Ω—ã—Ö
- üåü **–ò–∑–±—Ä–∞–Ω–Ω–æ–µ** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ - —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–Ω—É—Ç—Ä–∏ Telegram
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram –∞–∫–∫–∞—É–Ω—Ç
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–¥ –ª—é–±—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- ‚úÖ Production-ready –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
- ‚úÖ –í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
- ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

## ‚ú® –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### üë§ –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è** - –ø–æ–ª–Ω–∞—è –∞–Ω–∫–µ—Ç–∞ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –≤—Å–µ—Ö –ø–æ–ª–µ–π
  - –ò–º—è (2-50 —Å–∏–º–≤–æ–ª–æ–≤)
  - –í–æ–∑—Ä–∞—Å—Ç (18+ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  - –ü–æ–ª (–º—É–∂—Å–∫–æ–π/–∂–µ–Ω—Å–∫–∏–π/–¥—Ä—É–≥–æ–µ)
  - –°–µ–∫—Å—É–∞–ª—å–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è
  - –¶–µ–ª–∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ (—Å–µ—Ä—å–µ–∑–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è, –¥—Ä—É–∂–±–∞, etc.)
  - –ë–∏–æ–≥—Ä–∞—Ñ–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–æ 500 —Å–∏–º–≤–æ–ª–æ–≤)
  
- **–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏**
  - –î–æ 3 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –ø—Ä–æ—Ñ–∏–ª—è
  - –§–æ—Ä–º–∞—Ç—ã: JPEG, PNG, WebP
  - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 5 –ú–ë –Ω–∞ —Ñ–æ—Ç–æ
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  
- **–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è**
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è
  - –†—É—á–Ω–æ–π –≤—ã–±–æ—Ä –≥–æ—Ä–æ–¥–∞ (–µ—Å–ª–∏ –∑–∞–ø—Ä–µ—Ç–∏–ª–∏ GPS)
  - –•—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ geohash –¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ (~5–∫–º —Ç–æ—á–Ω–æ—Å—Ç—å)
  - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –ø–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é
  
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏**
  - –°–∫—Ä—ã—Ç—å —Ç–æ—á–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç
  - –°–∫—Ä—ã—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - –°–∫—Ä—ã—Ç—å —Å—Ç–∞—Ç—É—Å "–æ–Ω–ª–∞–π–Ω"

### üîç –ü–æ–∏—Å–∫ –∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞

- **Discovery (–ü—Ä–æ—Å–º–æ—Ç—Ä –∞–Ω–∫–µ—Ç)**
  - –ö–∞—Ä—Ç–æ—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–æ—Ñ–∏–ª–µ–π
  - –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø—Ä–æ–ª–∏—Å—Ç—ã–≤–∞–Ω–∏—è
  - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ: –≤–æ–∑—Ä–∞—Å—Ç, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ, –±–∏–æ–≥—Ä–∞—Ñ–∏—è
  - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è–º –∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é
  
- **–î–µ–π—Å—Ç–≤–∏—è —Å –ø—Ä–æ—Ñ–∏–ª—è–º–∏**
  - ‚ù§Ô∏è **–õ–∞–π–∫** - –≤—ã—Ä–∞–∑–∏—Ç—å —Å–∏–º–ø–∞—Ç–∏—é
  - ‚úñÔ∏è **–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å** - –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –ø—Ä–æ—Ñ–∏–ª—é
  - ‚≠ê **–°—É–ø–µ—Ä–ª–∞–π–∫** - –æ—Å–æ–±–∞—è —Å–∏–º–ø–∞—Ç–∏—è (–±—É–¥—É—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è)
  - üåü **–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ** - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
  
- **–ú–∞—Ç—á–∏–Ω–≥**
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç—á–∞ –ø—Ä–∏ –≤–∑–∞–∏–º–Ω–æ–º –ª–∞–π–∫–µ
  - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–º –º–∞—Ç—á–µ
  - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–∞—Ç—á–µ–π —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
  
- **–ò–∑–±—Ä–∞–Ω–Ω–æ–µ**
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π
  - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö
  - –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ

### üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

- **Telegram –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**
  - HMAC –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –æ—Ç Telegram
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ –∏ –≤—Ä–µ–º–µ–Ω–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
  - –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏ –¥–∞–Ω–Ω—ã—Ö
  
- **JWT —Ç–æ–∫–µ–Ω—ã**
  - –°–µ—Ä–≤–µ—Ä–Ω—ã–µ —Å–µ—Å—Å–∏–∏ —Å –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
  - –ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
  
- **Rate Limiting**
  - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
  - –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π –∏ —Å–ø–∞–º–∞
  - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
  
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞ 18+ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –∏ —Å–µ—Ä–≤–µ—Ä–µ
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π –ø—Ä–æ—Ñ–∏–ª—è
  - –ó–∞—â–∏—Ç–∞ –æ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–π —á–µ—Ä–µ–∑ ORM
  - –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

### –ß—Ç–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- ‚úÖ –ü–æ–∏—Å–∫ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –ª–∞–π–∫–æ–≤ –∏ –º–∞—Ç—á–∏–Ω–≥–∞
- ‚úÖ –ò–∑–±—Ä–∞–Ω–Ω–æ–µ
- ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
- ‚úÖ HTTP API –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- üöß –ß–∞—Ç –º–µ–∂–¥—É —Å–æ–≤–ø–∞–≤—à–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- üöß Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –º–∞—Ç—á–∞—Ö –∏ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
- üöß –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ–∏—Å–∫–∞
- üöß –°–∏—Å—Ç–µ–º–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- üöß –ü–ª–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (Telegram Stars)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker –∏ Docker Compose v2.0+
- Telegram –±–æ—Ç —Ç–æ–∫–µ–Ω –æ—Ç [@BotFather](https://t.me/BotFather)
- (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –î–æ–º–µ–Ω –¥–ª—è production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞ –≤ Telegram

1. –û—Ç–∫—Ä–æ–π—Ç–µ [@BotFather](https://t.me/BotFather) –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º: —É–∫–∞–∂–∏—Ç–µ –∏–º—è –∏ username –±–æ—Ç–∞
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω (—Ñ–æ—Ä–º–∞—Ç: `123456789:ABCdef...`)
5. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–æ—Ç–∞:
   ```
   /setdescription - –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤
   /setabouttext - Dating app in Telegram
   /setuserpic - –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∞–≤–∞—Ç–∞—Ä –±–æ—Ç–∞
   ```

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/erliona/dating.git
cd dating

# 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env –∏ —É–∫–∞–∂–∏—Ç–µ –≤–∞—à BOT_TOKEN

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
docker compose -f docker-compose.dev.yml up -d

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose ps

# 5. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
docker compose logs -f bot

# 6. –û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞ –≤ Telegram –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å /start
```

### –ó–∞–ø—É—Å–∫ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º

```bash
# –ó–∞–ø—É—Å–∫ —Å –ø–æ–ª–Ω—ã–º —Å—Ç–µ–∫–æ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
docker compose --profile monitoring up -d

# –î–æ—Å—Ç—É–ø –∫ –¥–∞—à–±–æ—Ä–¥–∞–º:
# Grafana:    http://localhost:3000 (admin/admin)
# Prometheus: http://localhost:9090
# Mini App:   http://localhost (—á–µ—Ä–µ–∑ –±–æ—Ç–∞)
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**
   ```bash
   docker compose exec db psql -U dating -d dating -c "SELECT count(*) FROM users;"
   ```

2. **API –±–æ—Ç–∞**
   ```bash
   curl -X GET "http://localhost:8080/health"
   ```

3. **Telegram –±–æ—Ç**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –≤ Telegram
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
   - –î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –∫–Ω–æ–ø–∫–∞ "üöÄ –û—Ç–∫—Ä—ã—Ç—å Mini App"

4. **Mini App**
   - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –æ—Ç–∫—Ä—ã—Ç–∏—è Mini App
   - –î–æ–ª–∂–µ–Ω –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è —ç–∫—Ä–∞–Ω –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Telegram User  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Telegram Mini App (WebApp)          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇDiscovery ‚îÇ  ‚îÇ Matches  ‚îÇ  ‚îÇ Settings ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  Screen  ‚îÇ  ‚îÇ  Screen  ‚îÇ  ‚îÇ  Screen  ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ         HTML + CSS + JavaScript             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ HTTP API / WebApp.sendData()
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           Telegram Bot (Backend)            ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  Bot Handlers (aiogram)             ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  - /start command                   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  - WebApp data handler              ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  - Callbacks                        ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  HTTP API (aiohttp)                 ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  - /api/profile                     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  - /api/discover                    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  - /api/like                        ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  - /api/matches                     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  - /api/favorites                   ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  Business Logic                     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  - Authentication (JWT, HMAC)       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  - Validation                       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  - Matching algorithm               ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  - Geolocation processing           ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  Data Access Layer (Repository)     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  - ProfileRepository                ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  - InteractionRepository            ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  - MatchRepository                  ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ SQLAlchemy (async)
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         PostgreSQL Database                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  users   ‚îÇ  ‚îÇ profiles ‚îÇ  ‚îÇ  photos  ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇinteractions‚îÇ ‚îÇ matches  ‚îÇ  ‚îÇfavorites ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

#### 1. Frontend (Telegram Mini App)
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**: –ß–∏—Å—Ç—ã–π HTML/CSS/JavaScript –±–µ–∑ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤
- **–≠–∫—Ä–∞–Ω—ã**: Onboarding, Profile, Discovery, Matches, Favorites, Settings
- **–§—É–Ω–∫—Ü–∏–∏**:
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram WebApp API
  - –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫ —Ç–µ–º–µ Telegram (—Å–≤–µ—Ç–ª–∞—è/—Ç–µ–º–Ω–∞—è)
  - Haptic feedback –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è UX
  - Offline-ready —Å –æ—á–µ—Ä–µ–¥—å—é –¥–µ–π—Å—Ç–≤–∏–π
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

#### 2. Backend (Python Bot)
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**: Python 3.11+, aiogram 3.x, aiohttp
- **–ú–æ–¥—É–ª–∏**:
  - `main.py` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞
  - `api.py` - HTTP API –¥–ª—è Mini App
  - `db.py` - –º–æ–¥–µ–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
  - `repository.py` - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
  - `validation.py` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
  - `security.py` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
  - `geo.py` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
  - `media.py` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
  - `cache.py` - –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å TTL
  - `config.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

#### 3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)
- **–¢–∞–±–ª–∏—Ü—ã**:
  - `users` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Telegram
  - `profiles` - –∞–Ω–∫–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - `photos` - —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø—Ä–æ—Ñ–∏–ª–µ–π
  - `interactions` - –ª–∞–π–∫–∏/–¥–∏–∑–ª–∞–π–∫–∏
  - `matches` - –≤–∑–∞–∏–º–Ω—ã–µ —Å–∏–º–ø–∞—Ç–∏–∏
  - `favorites` - –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
  - Async –¥—Ä–∞–π–≤–µ—Ä (asyncpg)
  - –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
  - Constraints –¥–ª—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
  - –ú–∏–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Alembic

#### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **Prometheus** - –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **Grafana** - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –¥–∞—à–±–æ—Ä–¥—ã
- **Loki** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏
- **cAdvisor** - –º–µ—Ç—Ä–∏–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

#### –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
```
1. User -> Mini App: –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É –ø—Ä–æ—Ñ–∏–ª—è
2. Mini App: –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
3. Mini App -> Bot: tg.sendData(profileData)
4. Bot: –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ WebApp handler
5. Bot: –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
6. Bot -> DB: —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç user, profile, photos
7. Bot -> User: –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
```

#### –ü–æ–∏—Å–∫ –∏ –º–∞—Ç—á–∏–Ω–≥
```
1. Mini App -> API: GET /api/discover?limit=10
2. API: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç JWT —Ç–æ–∫–µ–Ω
3. Repository: –≤—ã–±–∏—Ä–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª–∏ –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º
   - –ò—Å–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ
   - –§–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é (geohash)
   - –§–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è–º
4. API -> Mini App: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ñ–∏–ª–µ–π
5. User: –¥–µ–ª–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ (like/pass)
6. Mini App -> API: POST /api/like {target_id}
7. Repository: —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç interaction
8. Repository: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–∑–∞–∏–º–Ω–æ—Å—Ç—å
9. IF –≤–∑–∞–∏–º–Ω—ã–π like -> —Å–æ–∑–¥–∞–µ—Ç match
10. API -> Mini App: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–ù–∞ –≤—Ö–æ–¥–µ**: HMAC –≤–∞–ª–∏–¥–∞—Ü–∏—è Telegram initData
- **–°–µ—Å—Å–∏–∏**: JWT —Ç–æ–∫–µ–Ω—ã —Å TTL 24 —á–∞—Å–∞
- **API**: Rate limiting –Ω–∞ –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: SQL injection protection —á–µ—Ä–µ–∑ ORM
- **–ü–∞—Ä–æ–ª–∏**: –ù–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram
- **HTTPS**: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤ production (Let's Encrypt)

## üîê –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

```bash
# Telegram Bot
BOT_TOKEN=123456789:ABCdef...          # –¢–æ–∫–µ–Ω –æ—Ç @BotFather

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
POSTGRES_DB=dating                     # –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
POSTGRES_USER=dating                   # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î
POSTGRES_PASSWORD=secure_password      # –ü–∞—Ä–æ–ª—å –ë–î (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å!)

# JWT
JWT_SECRET=your-secret-key-here        # –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è JWT —Ç–æ–∫–µ–Ω–æ–≤
```

#### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–¥–ª—è production —Å HTTPS)

```bash
# –î–æ–º–µ–Ω –∏ SSL
DOMAIN=yourdomain.com                  # –í–∞—à –¥–æ–º–µ–Ω
WEBAPP_URL=https://${DOMAIN}           # URL Mini App
ACME_EMAIL=admin@yourdomain.com        # Email –¥–ª—è Let's Encrypt

# API
API_PORT=8080                          # –ü–æ—Ä—Ç HTTP API (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 8080)

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
ENABLE_MONITORING=true                 # –í–∫–ª—é—á–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```

#### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```bash
# –õ–∏–º–∏—Ç—ã
MAX_PHOTO_SIZE_MB=5                    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–æ—Ç–æ
MAX_PHOTOS_PER_PROFILE=3               # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ—Ç–æ –≤ –ø—Ä–æ—Ñ–∏–ª–µ

# –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è
DEFAULT_SEARCH_RADIUS_KM=50            # –†–∞–¥–∏—É—Å –ø–æ–∏—Å–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
GEOHASH_PRECISION=5                    # –¢–æ—á–Ω–æ—Å—Ç—å geohash (5 = ~5–∫–º)

# Rate Limiting
RATE_LIMIT_REQUESTS=100                # –ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
RATE_LIMIT_PERIOD=60                   # –ü–µ—Ä–∏–æ–¥ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DB_POOL_SIZE=10                        # –†–∞–∑–º–µ—Ä –ø—É–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
DB_MAX_OVERFLOW=20                     # –ú–∞–∫—Å–∏–º—É–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
LOG_LEVEL=INFO                         # –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (DEBUG, INFO, WARNING, ERROR)
JSON_LOGS=true                         # –õ–æ–≥–∏ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
```

### –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞

```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä
cp .env.example .env

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∏ –¥–æ–±–∞–≤—å—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
nano .env  # –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª—é–±–æ–π —Ä–µ–¥–∞–∫—Ç–æ—Ä

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª –Ω–µ –ø–æ–ø–∞–¥–µ—Ç –≤ git
cat .gitignore | grep .env
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

‚ö†Ô∏è **–í–∞–∂–Ω–æ:**
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` —Ñ–∞–π–ª –≤ git
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è –ë–î
- –•—Ä–∞–Ω–∏—Ç–µ JWT_SECRET –≤ —Å–µ–∫—Ä–µ—Ç–µ
- –í production –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ secrets management (GitHub Secrets, Vault, etc.)

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω—ã
docker compose config

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
docker compose exec db psql -U dating -d dating -c "SELECT version();"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–æ—Ç–∞
docker compose logs bot | grep "Bot started"
```

## üíæ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

#### –¢–∞–±–ª–∏—Ü–∞: users
–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö Telegram.

```sql
CREATE TABLE users (
    id BIGINT PRIMARY KEY,           -- Telegram user ID
    username VARCHAR(255),           -- Telegram username
    first_name VARCHAR(255),         -- –ò–º—è –≤ Telegram
    created_at TIMESTAMP,            -- –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
    last_active TIMESTAMP            -- –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
);
```

#### –¢–∞–±–ª–∏—Ü–∞: profiles
–ê–Ω–∫–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤.

```sql
CREATE TABLE profiles (
    id SERIAL PRIMARY KEY,
    user_id BIGINT UNIQUE NOT NULL,  -- –°—Å—ã–ª–∫–∞ –Ω–∞ users.id
    name VARCHAR(50) NOT NULL,       -- –ò–º—è –≤ –ø—Ä–æ—Ñ–∏–ª–µ
    birth_date DATE NOT NULL,        -- –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è
    gender VARCHAR(20) NOT NULL,     -- –ü–æ–ª
    orientation VARCHAR(50),         -- –û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è
    looking_for VARCHAR(255),        -- –ò—â–µ—Ç
    goals TEXT,                      -- –¶–µ–ª–∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞
    bio TEXT,                        -- –û —Å–µ–±–µ
    city VARCHAR(100),               -- –ì–æ—Ä–æ–¥
    country VARCHAR(100),            -- –°—Ç—Ä–∞–Ω–∞
    latitude DECIMAL(10, 8),         -- –®–∏—Ä–æ—Ç–∞
    longitude DECIMAL(11, 8),        -- –î–æ–ª–≥–æ—Ç–∞
    geohash VARCHAR(20),             -- Geohash –¥–ª—è –ø–æ–∏—Å–∫–∞
    hide_age BOOLEAN,                -- –°–∫—Ä—ã—Ç—å –≤–æ–∑—Ä–∞—Å—Ç
    hide_distance BOOLEAN,           -- –°–∫—Ä—ã—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ
    hide_online BOOLEAN,             -- –°–∫—Ä—ã—Ç—å –æ–Ω–ª–∞–π–Ω
    created_at TIMESTAMP,
    updated_at TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

#### –¢–∞–±–ª–∏—Ü–∞: photos
–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø—Ä–æ—Ñ–∏–ª–µ–π.

```sql
CREATE TABLE photos (
    id SERIAL PRIMARY KEY,
    profile_id INTEGER NOT NULL,     -- –°—Å—ã–ª–∫–∞ –Ω–∞ profiles.id
    file_id VARCHAR(255) NOT NULL,   -- Telegram file_id
    file_path VARCHAR(500),          -- –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É
    position INTEGER,                -- –ü–æ—Ä—è–¥–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    created_at TIMESTAMP,
    FOREIGN KEY (profile_id) REFERENCES profiles(id) ON DELETE CASCADE
);
```

#### –¢–∞–±–ª–∏—Ü–∞: interactions
–ò—Å—Ç–æ—Ä–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

```sql
CREATE TABLE interactions (
    id SERIAL PRIMARY KEY,
    user_id BIGINT NOT NULL,         -- –ö—Ç–æ —Å–¥–µ–ª–∞–ª –¥–µ–π—Å—Ç–≤–∏–µ
    target_id BIGINT NOT NULL,       -- –ù–∞ –∫–æ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–æ
    action VARCHAR(20) NOT NULL,     -- like, pass, superlike
    created_at TIMESTAMP,
    UNIQUE (user_id, target_id),     -- –û–¥–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (target_id) REFERENCES users(id)
);
```

#### –¢–∞–±–ª–∏—Ü–∞: matches
–í–∑–∞–∏–º–Ω—ã–µ —Å–∏–º–ø–∞—Ç–∏–∏.

```sql
CREATE TABLE matches (
    id SERIAL PRIMARY KEY,
    user1_id BIGINT NOT NULL,        -- –ü–µ—Ä–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    user2_id BIGINT NOT NULL,        -- –í—Ç–æ—Ä–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    created_at TIMESTAMP,
    UNIQUE (user1_id, user2_id),
    CHECK (user1_id < user2_id),     -- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–µ–π
    FOREIGN KEY (user1_id) REFERENCES users(id),
    FOREIGN KEY (user2_id) REFERENCES users(id)
);
```

#### –¢–∞–±–ª–∏—Ü–∞: favorites
–ò–∑–±—Ä–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏.

```sql
CREATE TABLE favorites (
    id SERIAL PRIMARY KEY,
    user_id BIGINT NOT NULL,         -- –ö—Ç–æ –¥–æ–±–∞–≤–∏–ª
    target_id BIGINT NOT NULL,       -- –ö–æ–≥–æ –¥–æ–±–∞–≤–∏–ª–∏
    created_at TIMESTAMP,
    UNIQUE (user_id, target_id),
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (target_id) REFERENCES users(id)
);
```

### –ò–Ω–¥–µ–∫—Å—ã

```sql
-- –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ user_id
CREATE INDEX idx_profiles_user_id ON profiles(user_id);

-- –ü–æ–∏—Å–∫ –ø–æ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
CREATE INDEX idx_profiles_geohash ON profiles(geohash);

-- –ü–æ–∏—Å–∫ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
CREATE INDEX idx_interactions_user_id ON interactions(user_id);
CREATE INDEX idx_interactions_target_id ON interactions(target_id);

-- –ü–æ–∏—Å–∫ –º–∞—Ç—á–µ–π
CREATE INDEX idx_matches_user1 ON matches(user1_id);
CREATE INDEX idx_matches_user2 ON matches(user2_id);
```

### –ú–∏–≥—Ä–∞—Ü–∏–∏

#### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ –Ω–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏
docker compose exec bot alembic upgrade head

# –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é
docker compose exec bot alembic downgrade -1

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é
docker compose exec bot alembic current

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é –º–∏–≥—Ä–∞—Ü–∏–π
docker compose exec bot alembic history
```

#### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –º–æ–¥–µ–ª–µ–π
docker compose exec bot alembic revision --autogenerate -m "Add new field to profiles"

# –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏
docker compose exec bot alembic revision -m "Custom migration"
```

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞

```bash
# –ü–æ–ª–Ω—ã–π –¥–∞–º–ø –±–∞–∑—ã
docker compose exec db pg_dump -U dating dating > backup_$(date +%Y%m%d_%H%M%S).sql

# –¢–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ (–±–µ–∑ —Å—Ö–µ–º—ã)
docker compose exec db pg_dump -U dating dating --data-only > data_backup.sql

# –¢–æ–ª—å–∫–æ —Å—Ö–µ–º–∞ (–±–µ–∑ –¥–∞–Ω–Ω—ã—Ö)
docker compose exec db pg_dump -U dating dating --schema-only > schema_backup.sql

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
docker compose exec db pg_dump -U dating dating -t profiles > profiles_backup.sql
```

#### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–ª–Ω—ã–π –¥–∞–º–ø
docker compose exec -T db psql -U dating dating < backup.sql

# –û—á–∏—Å—Ç–∏—Ç—å –±–∞–∑—É –ø–µ—Ä–µ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º
docker compose exec db psql -U dating dating -c "DROP SCHEMA public CASCADE; CREATE SCHEMA public;"
docker compose exec -T db psql -U dating dating < backup.sql
```

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–π—Ç–µ cron –∑–∞–¥–∞—á—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
# –û—Ç–∫—Ä—ã—Ç—å crontab
crontab -e

# –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00)
0 3 * * * cd /path/to/dating && docker compose exec -T db pg_dump -U dating dating > /backups/dating_$(date +\%Y\%m\%d).sql

# –£–¥–∞–ª—è—Ç—å –±—ç–∫–∞–ø—ã —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π
0 4 * * * find /backups -name "dating_*.sql" -mtime +30 -delete
```

### Maintenance

#### –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```bash
# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ (–ø—Ä–∏–º–µ—Ä)
docker compose exec db psql -U dating dating << EOF
DELETE FROM profiles 
WHERE updated_at < NOW() - INTERVAL '1 year'
AND user_id NOT IN (SELECT user_id FROM interactions WHERE created_at > NOW() - INTERVAL '6 months');
EOF
```

#### –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–º–µ—Ä–∞ —Ç–∞–±–ª–∏—Ü

```bash
docker compose exec db psql -U dating dating -c "
SELECT 
    schemaname,
    tablename,
    pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) AS size
FROM pg_tables
WHERE schemaname = 'public'
ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;
"
```

#### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∞–∑—ã

```bash
# VACUUM –∏ ANALYZE –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
docker compose exec db psql -U dating dating -c "VACUUM ANALYZE;"

# REINDEX –¥–ª—è –≤—Å–µ—Ö –∏–Ω–¥–µ–∫—Å–æ–≤
docker compose exec db psql -U dating dating -c "REINDEX DATABASE dating;"
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

#### –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
python -m pytest tests/ -v

# –° –æ—Ç—á–µ—Ç–æ–º –æ –ø–æ–∫—Ä—ã—Ç–∏–∏
python -m pytest tests/ --cov=bot --cov-report=html --cov-report=term

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª —Ç–µ—Å—Ç–æ–≤
python -m pytest tests/test_validation.py -v

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
python -m pytest tests/test_validation.py::test_validate_name -v

# –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ –ø–æ–∫—Ä—ã—Ç–∏—è)
python -m pytest tests/ -q
```

#### –í Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker compose exec bot pytest tests/ -v

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
docker compose exec bot pytest tests/ --cov=bot --cov-report=term
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

–ü—Ä–æ–µ–∫—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç **293 —Ç–µ—Å—Ç–∞** —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º **81%**:

#### –ü–æ –º–æ–¥—É–ª—è–º

| –ú–æ–¥—É–ª—å | –¢–µ—Å—Ç–æ–≤ | –ü–æ–∫—Ä—ã—Ç–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|----------|----------|
| `test_validation.py` | 56 | 92% | –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π |
| `test_api.py` | 44 | 62% | HTTP API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã |
| `test_security.py` | 31 | 86% | JWT, HMAC, —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ |
| `test_media.py` | 30 | 84% | –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π |
| `test_geo.py` | 21 | 97% | –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –∏ geohash |
| `test_config.py` | 20 | 99% | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è |
| `test_main.py` | 19 | 90% | –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –±–æ—Ç–∞ |
| `test_repository.py` | 14 | 82% | CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –ë–î |
| `test_cache.py` | 11 | 97% | –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ |
| `test_database.py` | 47 | 100% | –ú–æ–¥–µ–ª–∏ –ë–î |

#### –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

- **–í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: 87 —Ç–µ—Å—Ç–æ–≤
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–µ–π –ø—Ä–æ—Ñ–∏–ª—è
  - JWT —Ç–æ–∫–µ–Ω—ã –∏ HMAC
  - Rate limiting
  - –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: 61 —Ç–µ—Å—Ç
  - –ú–æ–¥–µ–ª–∏ –∏ —Å–≤—è–∑–∏
  - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
  - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
  - Constraints

- **API –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: 63 —Ç–µ—Å—Ç–∞
  - HTTP endpoints
  - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
  - –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –±–æ—Ç–∞
  - WebApp –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

- **–£—Ç–∏–ª–∏—Ç—ã**: 82 —Ç–µ—Å—Ç–∞
  - –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è
  - –ú–µ–¥–∏–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞
  - –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
  - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

#### Unit —Ç–µ—Å—Ç—ã
–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:

```python
def test_validate_name():
    """–¢–µ—Å—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏–º–µ–Ω–∏."""
    assert validate_name("–ò–≤–∞–Ω") is True
    assert validate_name("A" * 51) is False
    assert validate_name("") is False
```

#### Integration —Ç–µ—Å—Ç—ã
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

```python
async def test_profile_creation_flow(db_session):
    """–¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è end-to-end."""
    # –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    user = User(id=123, username="test")
    db_session.add(user)
    
    # –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
    profile = Profile(user_id=123, name="Test", ...)
    db_session.add(profile)
    
    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
    result = await db_session.execute(
        select(Profile).where(Profile.user_id == 123)
    )
    assert result.scalar_one() is not None
```

#### API —Ç–µ—Å—Ç—ã
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ HTTP —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤:

```python
async def test_discover_endpoint(client, auth_token):
    """–¢–µ—Å—Ç API –ø–æ–∏—Å–∫–∞ –ø—Ä–æ—Ñ–∏–ª–µ–π."""
    response = await client.get(
        "/api/discover",
        headers={"Authorization": f"Bearer {auth_token}"}
    )
    assert response.status == 200
    data = await response.json()
    assert "profiles" in data
```

### –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞

#### –¢–µ–∫—É—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ

**–û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ: 81%**

–î–µ—Ç–∞–ª—å–Ω–æ –ø–æ –º–æ–¥—É–ª—è–º:
- ‚úÖ `bot/db.py`: **100%** - –º–æ–¥–µ–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ `bot/config.py`: **99%** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ `bot/cache.py`: **97%** - –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ `bot/geo.py`: **97%** - –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è
- ‚úÖ `bot/validation.py`: **92%** - –≤–∞–ª–∏–¥–∞—Ü–∏—è
- ‚úÖ `bot/main.py`: **90%** - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –±–æ—Ç–∞
- ‚úÖ `bot/security.py`: **86%** - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ `bot/media.py`: **84%** - –º–µ–¥–∏–∞
- ‚ö†Ô∏è `bot/repository.py`: **82%** - —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- ‚ö†Ô∏è `bot/api.py`: **62%** - HTTP API

#### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞

```bash
# –°–æ–∑–¥–∞—Ç—å HTML –æ—Ç—á–µ—Ç
pytest --cov=bot --cov-report=html

# –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ
open htmlcov/index.html  # macOS
xdg-open htmlcov/index.html  # Linux
```

### CI/CD —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–¢–µ—Å—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ GitHub Actions –ø—Ä–∏:
- Push –≤ main –≤–µ—Ç–∫—É
- –°–æ–∑–¥–∞–Ω–∏–∏ Pull Request
- –†—É—á–Ω–æ–º –∑–∞–ø—É—Å–∫–µ workflow

–ü—Ä–æ–≤–µ—Ä–∫–∏ –≤ CI:
1. ‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å Python
2. ‚úÖ –í—Å–µ unit —Ç–µ—Å—Ç—ã
3. ‚úÖ –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ (–º–∏–Ω–∏–º—É–º 80%)
4. ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
5. ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (pip-audit)
6. ‚úÖ –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞

### –ù–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∞

```python
import pytest
from bot.validation import validate_age

def test_validate_age_valid():
    """–¢–µ—Å—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞."""
    # Arrange - –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞
    birth_date = "1990-01-01"
    
    # Act - –¥–µ–π—Å—Ç–≤–∏–µ
    result = validate_age(birth_date)
    
    # Assert - –ø—Ä–æ–≤–µ—Ä–∫–∞
    assert result is True

def test_validate_age_under_18():
    """–¢–µ—Å—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –≤–æ–∑—Ä–∞—Å—Ç–∞ –º–ª–∞–¥—à–µ 18."""
    birth_date = "2010-01-01"
    result = validate_age(birth_date)
    assert result is False
```

#### –§–∏–∫—Å—Ç—É—Ä—ã

```python
@pytest.fixture
async def db_session():
    """–§–∏–∫—Å—Ç—É—Ä–∞ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ –ë–î."""
    engine = create_async_engine("sqlite+aiosqlite:///:memory:")
    async with engine.begin() as conn:
        await conn.run_sync(Base.metadata.create_all)
    
    async_session = sessionmaker(
        engine, class_=AsyncSession, expire_on_commit=False
    )
    
    async with async_session() as session:
        yield session
```

### –û—Ç–ª–∞–¥–∫–∞ —Ç–µ—Å—Ç–æ–≤

```bash
# –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥
pytest tests/ -vv

# –ü–æ–∫–∞–∑–∞—Ç—å print() –≤ —Ç–µ—Å—Ç–∞—Ö
pytest tests/ -s

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –Ω–∞ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ
pytest tests/ -x

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ —É–ø–∞–≤—à–∏–µ —Ç–µ—Å—Ç—ã
pytest tests/ --lf

# –û—Ç–ª–∞–¥—á–∏–∫ –ø—Ä–∏ –æ—à–∏–±–∫–µ
pytest tests/ --pdb
```

## üìä Monitoring

### Grafana Dashboards

**1. System Overview** - Infrastructure metrics
- Container CPU and memory usage
- PostgreSQL connections
- Network traffic
- All logs with JSON parsing

**2. Application Logs & Events** - Application monitoring
- Bot lifecycle events
- Error and warning counts
- Log levels over time
- Structured event logging

**3. Discovery & Matching** - User interaction metrics
- Discovery actions
- Likes, passes, matches
- User actions distribution

### Accessing Dashboards

```bash
# Start with monitoring
docker compose --profile monitoring up -d

# Access Grafana
open http://localhost:3000  # Default: admin/admin

# Check Prometheus
open http://localhost:9090
```

### Structured Logging

All logs are JSON formatted with:
- Timestamp (ISO 8601)
- Level (INFO, WARNING, ERROR)
- Logger name
- Message
- Module, function, line number
- Custom fields (user_id, event_type, etc.)

## üö¢ Deployment

### Production Deployment

**Using GitHub Actions (Recommended):**

1. Configure GitHub Secrets:
   - `DEPLOY_HOST` - Server IP/hostname
   - `DEPLOY_USER` - SSH user
   - `DEPLOY_SSH_KEY` - Private SSH key
   - `BOT_TOKEN` - Telegram bot token

2. Push to main branch - automatic deployment!

**Manual Deployment:**

```bash
# On server
git pull origin main
docker compose up -d --build

# Check status
docker compose ps

# View logs
docker compose logs -f
```

### Updating

```bash
# Pull latest changes
git pull origin main

# Restart services
docker compose restart bot webapp

# Apply migrations
docker compose exec bot alembic upgrade head
```

## üõ°Ô∏è Security

### Best Practices
- ‚úÖ All secrets in environment variables
- ‚úÖ HTTPS everywhere via Traefik
- ‚úÖ JWT authentication for API
- ‚úÖ HMAC validation for Telegram data
- ‚úÖ SQL injection protection via ORM
- ‚úÖ No hardcoded credentials
- ‚úÖ Automated security scanning in CI

### Reporting Security Issues

Email security concerns to the repository owner. Do not create public issues for security vulnerabilities.

## üêõ Troubleshooting

### Bot Not Responding

```bash
# Check logs
docker compose logs -f bot

# Restart bot
docker compose restart bot

# Check bot status
docker compose ps
```

### Database Connection Issues

```bash
# Check database status
docker compose ps db

# View database logs
docker compose logs db

# Test connection
docker compose exec db psql -U dating -d dating -c "SELECT 1;"
```

### Grafana Not Loading

```bash
# Restart Grafana
docker compose --profile monitoring restart grafana

# Check logs
docker compose logs grafana

# Verify datasources
curl -u admin:admin http://localhost:3000/api/datasources
```

## üìö Additional Resources

### Documentation
- [Full Documentation Index](docs/INDEX.md)
- [Architecture Details](docs/ARCHITECTURE.md)
- [Deployment Guide](docs/DEPLOYMENT.md)
- [Testing Guide](docs/TESTING.md)
- [API Documentation](docs/PHOTO_UPLOAD_API.md)

### Development
- [Contributing Guidelines](CONTRIBUTING.md)
- [Changelog](CHANGELOG.md)
- [Roadmap](ROADMAP.md)
- [Project Status](PROJECT_STATUS.md)

### External Links
- [GitHub Repository](https://github.com/erliona/dating)
- [GitHub Issues](https://github.com/erliona/dating/issues)
- [Telegram Bot API](https://core.telegram.org/bots/api)
- [aiogram Documentation](https://docs.aiogram.dev/)

## ü§ù Contributing

We welcome contributions! Please see [CONTRIBUTING.md](CONTRIBUTING.md) for:
- Code of conduct
- Development setup
- Pull request process
- Coding standards

## üìÑ License

This project is licensed under the MIT License - see [LICENSE](LICENSE) for details.

## üí¨ Support

- **Documentation**: See [docs/](docs/)
- **Bug Reports**: [GitHub Issues](https://github.com/erliona/dating/issues)
- **Questions**: [GitHub Discussions](https://github.com/erliona/dating/discussions)

---

**Made with ‚ù§Ô∏è for the community**

*If you find this project useful, please star it on GitHub!* ‚≠ê
